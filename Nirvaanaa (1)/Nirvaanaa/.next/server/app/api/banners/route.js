"use strict";(()=>{var e={};e.id=4159,e.ids=[4159],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},94926:(e,t,n)=>{n.r(t),n.d(t,{headerHooks:()=>h,originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>A});var a={};n.r(a),n.d(a,{GET:()=>c});var r=n(95419),i=n(69108),o=n(99678),s=n(59269),u=n(88578),d=n(78070);async function c(){try{await (0,u.Z)();let e=await s.Z.findAdBanner(),t=await s.Z.findAnnouncementBanner(),n=e||await s.Z.findOne({type:"adbanner"}).sort({createdAt:-1}).lean(),a=t||await s.Z.findOne({type:"announcement"}).sort({createdAt:-1}).lean();return d.Z.json({banners:{ad:n||null,announcement:a||null}},{status:200})}catch(e){return console.error("GET /api/banners error:",e),d.Z.json({error:"Failed to fetch banners"},{status:500})}}let l=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/banners/route",pathname:"/api/banners",filename:"route",bundlePath:"app/api/banners/route"},resolvedPagePath:"C:\\Users\\Ananya\\Downloads\\Nirvaanaa_current\\Nirvaanaa (1)\\Nirvaanaa\\app\\api\\banners\\route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:f,headerHooks:h,staticGenerationBailout:A}=l,v="/api/banners/route";function y(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},88578:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(11185),r=n.n(a);let i=process.env.MONGODB_URI;if(!i)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose;o||(o=global.mongoose={conn:null,promise:null});let s=async function(){if(o.conn)return o.conn;o.promise||(o.promise=r().connect(i,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}},59269:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(11185),r=n.n(a);let i=new(r()).Schema({text:{type:String,maxlength:[200,"Text cannot be more than 200 characters"],trim:!0},type:{type:String,enum:["announcement","adbanner"],default:"announcement",required:!0},isAnnouncementActive:{type:Boolean,default:!1},isAdBannerActive:{type:Boolean,default:!1},backgroundColor:{type:String,default:"#f59e0b",match:[/^#[0-9A-F]{6}$/i,"Please enter a valid hex color"]},textColor:{type:String,default:"#ffffff",match:[/^#[0-9A-F]{6}$/i,"Please enter a valid hex color"]},link:{url:String,text:String},image:{type:String,required:!1},priority:{type:Number,default:1,min:1,max:10},startDate:{type:Date,default:Date.now},endDate:{type:Date},createdBy:{type:r().Schema.Types.ObjectId,ref:"User",required:!0}},{timestamps:!0});i.index({isAnnouncementActive:1}),i.index({isAdBannerActive:1}),i.index({priority:-1}),i.index({startDate:1,endDate:1}),i.virtual("isAnnouncementCurrentlyActive").get(function(){if(!this.isAnnouncementActive)return!1;let e=new Date;return(!this.startDate||!(e<this.startDate))&&(!this.endDate||!(e>this.endDate))}),i.virtual("isAdBannerCurrentlyActive").get(function(){if(!this.isAdBannerActive)return!1;let e=new Date;return(!this.startDate||!(e<this.startDate))&&(!this.endDate||!(e>this.endDate))}),i.statics.findAnnouncementBanner=function(){let e=new Date;return this.findOne({type:"announcement",isAnnouncementActive:!0,$and:[{$or:[{startDate:{$lte:e}},{startDate:{$exists:!1}}]},{$or:[{endDate:{$gte:e}},{endDate:{$exists:!1}}]}]}).sort({priority:-1,createdAt:-1})},i.statics.findAdBanner=function(){let e=new Date;return this.findOne({type:"adbanner",isAdBannerActive:!0,$and:[{$or:[{startDate:{$lte:e}},{startDate:{$exists:!1}}]},{$or:[{endDate:{$gte:e}},{endDate:{$exists:!1}}]}]}).sort({priority:-1,createdAt:-1})};let o=r().models.Announcement||r().model("Announcement",i)}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),a=t.X(0,[1638,6206],()=>n(94926));module.exports=a})();