"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/payment-intent/route";
exports.ids = ["app/api/payment-intent/route"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist\\client\\components\\action-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist\\client\\components\\request-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!*********************************************************************************************!*\
  !*** external "next/dist\\client\\components\\static-generation-async-storage.external.js" ***!
  \*********************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\static-generation-async-storage.external.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "cluster":
/*!**************************!*\
  !*** external "cluster" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("cluster");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpayment-intent%2Froute&page=%2Fapi%2Fpayment-intent%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpayment-intent%2Froute.js&appDir=C%3A%5CUsers%5CAnanya%5CDownloads%5CNirvaanaa_current%5CNirvaanaa%20(1)%5CNirvaanaa%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAnanya%5CDownloads%5CNirvaanaa_current%5CNirvaanaa%20(1)%5CNirvaanaa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpayment-intent%2Froute&page=%2Fapi%2Fpayment-intent%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpayment-intent%2Froute.js&appDir=C%3A%5CUsers%5CAnanya%5CDownloads%5CNirvaanaa_current%5CNirvaanaa%20(1)%5CNirvaanaa%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAnanya%5CDownloads%5CNirvaanaa_current%5CNirvaanaa%20(1)%5CNirvaanaa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Ananya_Downloads_Nirvaanaa_current_Nirvaanaa_1_Nirvaanaa_app_api_payment_intent_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/payment-intent/route.js */ \"(rsc)/./app/api/payment-intent/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/payment-intent/route\",\n        pathname: \"/api/payment-intent\",\n        filename: \"route\",\n        bundlePath: \"app/api/payment-intent/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Ananya\\\\Downloads\\\\Nirvaanaa_current\\\\Nirvaanaa (1)\\\\Nirvaanaa\\\\app\\\\api\\\\payment-intent\\\\route.js\",\n    nextConfigOutput,\n    userland: C_Users_Ananya_Downloads_Nirvaanaa_current_Nirvaanaa_1_Nirvaanaa_app_api_payment_intent_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/payment-intent/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwYXltZW50LWludGVudCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGcGF5bWVudC1pbnRlbnQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZwYXltZW50LWludGVudCUyRnJvdXRlLmpzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNBbmFueWElNUNEb3dubG9hZHMlNUNOaXJ2YWFuYWFfY3VycmVudCU1Q05pcnZhYW5hYSUyMCgxKSU1Q05pcnZhYW5hYSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDQW5hbnlhJTVDRG93bmxvYWRzJTVDTmlydmFhbmFhX2N1cnJlbnQlNUNOaXJ2YWFuYWElMjAoMSklNUNOaXJ2YWFuYWEmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDNkQ7QUFDMUk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uaXJ2YWFuYWEtZWNvbW1lcmNlLz81YjMxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXEFuYW55YVxcXFxEb3dubG9hZHNcXFxcTmlydmFhbmFhX2N1cnJlbnRcXFxcTmlydmFhbmFhICgxKVxcXFxOaXJ2YWFuYWFcXFxcYXBwXFxcXGFwaVxcXFxwYXltZW50LWludGVudFxcXFxyb3V0ZS5qc1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcGF5bWVudC1pbnRlbnQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9wYXltZW50LWludGVudFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcGF5bWVudC1pbnRlbnQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxBbmFueWFcXFxcRG93bmxvYWRzXFxcXE5pcnZhYW5hYV9jdXJyZW50XFxcXE5pcnZhYW5hYSAoMSlcXFxcTmlydmFhbmFhXFxcXGFwcFxcXFxhcGlcXFxccGF5bWVudC1pbnRlbnRcXFxccm91dGUuanNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcGF5bWVudC1pbnRlbnQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpayment-intent%2Froute&page=%2Fapi%2Fpayment-intent%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpayment-intent%2Froute.js&appDir=C%3A%5CUsers%5CAnanya%5CDownloads%5CNirvaanaa_current%5CNirvaanaa%20(1)%5CNirvaanaa%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAnanya%5CDownloads%5CNirvaanaa_current%5CNirvaanaa%20(1)%5CNirvaanaa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/payment-intent/route.js":
/*!*****************************************!*\
  !*** ./app/api/payment-intent/route.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.js\");\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/mongodb */ \"(rsc)/./lib/mongodb.js\");\n/* harmony import */ var _models_Product__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/models/Product */ \"(rsc)/./models/Product.js\");\n/* harmony import */ var _models_Order__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/models/Order */ \"(rsc)/./models/Order.js\");\n/* harmony import */ var _models_Shipping__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/models/Shipping */ \"(rsc)/./models/Shipping.js\");\n/* harmony import */ var razorpay__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! razorpay */ \"(rsc)/./node_modules/razorpay/dist/razorpay.js\");\n/* harmony import */ var razorpay__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(razorpay__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _lib_rateLimit__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/lib/rateLimit */ \"(rsc)/./lib/rateLimit.js\");\n\n\n\n\n\n\n\n\n\n\n// Initialize Razorpay client\nconst razorpay = new (razorpay__WEBPACK_IMPORTED_MODULE_7___default())({\n    key_id: process.env.RAZORPAY_KEY_ID,\n    key_secret: process.env.RAZORPAY_KEY_SECRET\n});\n/**\n * Creates a Razorpay order for the checkout\n * Supports UPI, cards, wallets, and other payment methods\n */ async function POST(request) {\n    // Apply rate limiting\n    const rateLimitResponse = await (0,_lib_rateLimit__WEBPACK_IMPORTED_MODULE_9__.rateLimit)(request, \"payment\");\n    if (rateLimitResponse) {\n        return rateLimitResponse;\n    }\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Authentication required\"\n            }, {\n                status: 401\n            });\n        }\n        if (!process.env.RAZORPAY_KEY_ID || !process.env.RAZORPAY_KEY_SECRET) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Razorpay is not configured. Please add RAZORPAY_KEY_ID and RAZORPAY_KEY_SECRET to your environment variables.\"\n            }, {\n                status: 500\n            });\n        }\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n        const body = await request.json();\n        const { items, shippingAddress, shipping: shippingBody, billingAddress, shippingMethod = \"Standard Shipping\" } = body;\n        // Accept either shippingAddress or shipping\n        const shipping = shippingAddress || shippingBody;\n        if (!items || !Array.isArray(items) || items.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Cart items are required\"\n            }, {\n                status: 400\n            });\n        }\n        if (!shipping) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Shipping address is required\"\n            }, {\n                status: 400\n            });\n        }\n        // Normalize incoming item references to productId\n        const normalizedItems = items.map((i)=>({\n                ...i,\n                productId: i.productId || i.id || i._id\n            }));\n        const productIds = normalizedItems.map((item)=>item.productId).filter(Boolean);\n        if (productIds.length !== normalizedItems.length) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Invalid cart items\"\n            }, {\n                status: 400\n            });\n        }\n        const products = await _models_Product__WEBPACK_IMPORTED_MODULE_4__[\"default\"].find({\n            _id: {\n                $in: productIds\n            }\n        });\n        if (products.length !== productIds.length) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Some products not found\"\n            }, {\n                status: 400\n            });\n        }\n        // Calculate totals and validate stock\n        let subtotal = 0; // in rupees\n        let totalDiscount = 0; // in rupees\n        const orderItems = [];\n        for (const item of normalizedItems){\n            const product = products.find((p)=>p._id.toString() === item.productId);\n            if (!product) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: `Product ${item.productId} not found`\n                }, {\n                    status: 400\n                });\n            }\n            if (!product.published) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: `Product ${product.title} is not available`\n                }, {\n                    status: 400\n                });\n            }\n            // Validate stock\n            if (typeof product.stock === \"number\" && product.stock < item.quantity) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: `Insufficient stock for ${product.title}`\n                }, {\n                    status: 400\n                });\n            }\n            // Compute effective price after product-level discount\n            const discountPct = typeof product.discount === \"number\" ? product.discount : 0;\n            const effectivePrice = Math.round(product.price * (1 - discountPct / 100) || 0);\n            const itemTotal = effectivePrice * item.quantity;\n            const itemOriginalTotal = (product.price || 0) * item.quantity;\n            subtotal += itemTotal;\n            totalDiscount += Math.max(0, itemOriginalTotal - itemTotal);\n            orderItems.push({\n                productId: product._id,\n                name: product.title || product.name,\n                image: Array.isArray(product.images) ? typeof product.images[0] === \"string\" ? product.images[0] : product.images[0]?.url || \"\" : product.mainImage || \"\",\n                price: effectivePrice,\n                originalPrice: product.price,\n                discount: discountPct,\n                quantity: item.quantity,\n                sku: product.sku,\n                colorVariant: item.colorVariant || null\n            });\n        }\n        // Calculate shipping and tax - look up shipping method from database\n        let shippingCost = 100; // Default fallback\n        let gstPercent = 18; // Default 18% GST\n        let estimatedDays = 5; // Default\n        if (shippingMethod) {\n            const shippingMethodDoc = await _models_Shipping__WEBPACK_IMPORTED_MODULE_6__[\"default\"].findOne({\n                name: shippingMethod,\n                isActive: true\n            });\n            if (shippingMethodDoc) {\n                shippingCost = shippingMethodDoc.cost || 100;\n                gstPercent = shippingMethodDoc.gstPercent || 18;\n                if (shippingMethodDoc.estimatedDays) {\n                    if (typeof shippingMethodDoc.estimatedDays === \"object\" && shippingMethodDoc.estimatedDays.max) {\n                        estimatedDays = shippingMethodDoc.estimatedDays.max;\n                    } else if (typeof shippingMethodDoc.estimatedDays === \"number\") {\n                        estimatedDays = shippingMethodDoc.estimatedDays;\n                    }\n                }\n            }\n        }\n        // Tax is calculated on subtotal + shipping cost\n        const tax = Math.round((subtotal + shippingCost) * gstPercent / 100);\n        const total = Math.round((subtotal + shippingCost + tax - totalDiscount) * 100); // Convert to paise\n        // Create order in database (pending payment)\n        const order = new _models_Order__WEBPACK_IMPORTED_MODULE_5__[\"default\"]({\n            userId: session.user.id,\n            items: orderItems,\n            subtotal,\n            tax,\n            shipping: shippingCost,\n            discount: totalDiscount,\n            total: subtotal + shippingCost + tax - totalDiscount,\n            currency: \"INR\",\n            paymentMethod: \"razorpay\",\n            status: \"pending\",\n            shippingAddress: shipping || shippingAddress,\n            billingAddress: billingAddress || shipping || shippingAddress,\n            shippingMethod: {\n                name: shippingMethod,\n                estimatedDays: estimatedDays\n            }\n        });\n        await order.save();\n        // Create Razorpay order\n        const razorpayOrderOptions = {\n            amount: total,\n            currency: \"INR\",\n            receipt: order.orderNumber || order._id.toString(),\n            notes: {\n                orderId: order._id.toString(),\n                userId: session.user.id,\n                shipping: JSON.stringify(shipping || {})\n            }\n        };\n        const razorpayOrder = await razorpay.orders.create(razorpayOrderOptions);\n        // Update order with Razorpay order ID\n        order.razorpayOrderId = razorpayOrder.id;\n        await order.save();\n        // Return order details for frontend\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            orderId: order._id.toString(),\n            razorpayOrderId: razorpayOrder.id,\n            amount: total,\n            currency: \"INR\",\n            key: process.env.RAZORPAY_KEY_ID\n        });\n    } catch (error) {\n        console.error(\"Razorpay order creation error:\", error);\n        // Handle specific Razorpay errors\n        if (error.statusCode === 400) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: error.error?.description || \"Invalid payment request\",\n                details: error.error?.field ? `Invalid field: ${error.error.field}` : undefined\n            }, {\n                status: 400\n            });\n        }\n        if (error.statusCode === 401) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Invalid Razorpay credentials. Please check your API keys.\"\n            }, {\n                status: 401\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: error.message || \"Failed to create payment order\",\n            details:  true ? error.stack : 0\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3BheW1lbnQtaW50ZW50L3JvdXRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTJDO0FBQ0U7QUFDSjtBQUNIO0FBQ0M7QUFDSjtBQUNNO0FBQ1Q7QUFDSjtBQUNnQjtBQUU1Qyw2QkFBNkI7QUFDN0IsTUFBTVUsV0FBVyxJQUFJSCxpREFBUUEsQ0FBQztJQUM1QkksUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxlQUFlO0lBQ25DQyxZQUFZSCxRQUFRQyxHQUFHLENBQUNHLG1CQUFtQjtBQUM3QztBQUVBOzs7Q0FHQyxHQUNNLGVBQWVDLEtBQUtDLE9BQU87SUFDaEMsc0JBQXNCO0lBQ3RCLE1BQU1DLG9CQUFvQixNQUFNVix5REFBU0EsQ0FBQ1MsU0FBUztJQUNuRCxJQUFJQyxtQkFBbUI7UUFDckIsT0FBT0E7SUFDVDtJQUVBLElBQUk7UUFDRixNQUFNQyxVQUFVLE1BQU1uQiwyREFBZ0JBLENBQUNDLGtEQUFXQTtRQUVsRCxJQUFJLENBQUNrQixTQUFTO1lBQ1osT0FBT3BCLGtGQUFZQSxDQUFDcUIsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUEwQixHQUNuQztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsSUFBSSxDQUFDWCxRQUFRQyxHQUFHLENBQUNDLGVBQWUsSUFBSSxDQUFDRixRQUFRQyxHQUFHLENBQUNHLG1CQUFtQixFQUFFO1lBQ3BFLE9BQU9oQixrRkFBWUEsQ0FBQ3FCLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBZ0gsR0FDekg7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1wQix3REFBU0E7UUFDZixNQUFNcUIsT0FBTyxNQUFNTixRQUFRRyxJQUFJO1FBQy9CLE1BQU0sRUFBRUksS0FBSyxFQUFFQyxlQUFlLEVBQUVDLFVBQVVDLFlBQVksRUFBRUMsY0FBYyxFQUFFQyxpQkFBaUIsbUJBQW1CLEVBQUUsR0FBR047UUFFakgsNENBQTRDO1FBQzVDLE1BQU1HLFdBQVdELG1CQUFtQkU7UUFFcEMsSUFBSSxDQUFDSCxTQUFTLENBQUNNLE1BQU1DLE9BQU8sQ0FBQ1AsVUFBVUEsTUFBTVEsTUFBTSxLQUFLLEdBQUc7WUFDekQsT0FBT2pDLGtGQUFZQSxDQUFDcUIsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQTBCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUMvRTtRQUVBLElBQUksQ0FBQ0ksVUFBVTtZQUNiLE9BQU8zQixrRkFBWUEsQ0FBQ3FCLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUErQixHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDcEY7UUFFQSxrREFBa0Q7UUFDbEQsTUFBTVcsa0JBQWtCVCxNQUFNVSxHQUFHLENBQUNDLENBQUFBLElBQU07Z0JBQ3RDLEdBQUdBLENBQUM7Z0JBQ0pDLFdBQVdELEVBQUVDLFNBQVMsSUFBSUQsRUFBRUUsRUFBRSxJQUFJRixFQUFFRyxHQUFHO1lBQ3pDO1FBRUEsTUFBTUMsYUFBYU4sZ0JBQWdCQyxHQUFHLENBQUNNLENBQUFBLE9BQVFBLEtBQUtKLFNBQVMsRUFBRUssTUFBTSxDQUFDQztRQUN0RSxJQUFJSCxXQUFXUCxNQUFNLEtBQUtDLGdCQUFnQkQsTUFBTSxFQUFFO1lBQ2hELE9BQU9qQyxrRkFBWUEsQ0FBQ3FCLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUFxQixHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDMUU7UUFFQSxNQUFNcUIsV0FBVyxNQUFNeEMsdURBQU9BLENBQUN5QyxJQUFJLENBQUM7WUFBRU4sS0FBSztnQkFBRU8sS0FBS047WUFBVztRQUFFO1FBRS9ELElBQUlJLFNBQVNYLE1BQU0sS0FBS08sV0FBV1AsTUFBTSxFQUFFO1lBQ3pDLE9BQU9qQyxrRkFBWUEsQ0FBQ3FCLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUEwQixHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDL0U7UUFFQSxzQ0FBc0M7UUFDdEMsSUFBSXdCLFdBQVcsR0FBRyxZQUFZO1FBQzlCLElBQUlDLGdCQUFnQixHQUFHLFlBQVk7UUFDbkMsTUFBTUMsYUFBYSxFQUFFO1FBRXJCLEtBQUssTUFBTVIsUUFBUVAsZ0JBQWlCO1lBQ2xDLE1BQU1nQixVQUFVTixTQUFTQyxJQUFJLENBQUNNLENBQUFBLElBQUtBLEVBQUVaLEdBQUcsQ0FBQ2EsUUFBUSxPQUFPWCxLQUFLSixTQUFTO1lBRXRFLElBQUksQ0FBQ2EsU0FBUztnQkFDWixPQUFPbEQsa0ZBQVlBLENBQUNxQixJQUFJLENBQ3RCO29CQUFFQyxPQUFPLENBQUMsUUFBUSxFQUFFbUIsS0FBS0osU0FBUyxDQUFDLFVBQVUsQ0FBQztnQkFBQyxHQUMvQztvQkFBRWQsUUFBUTtnQkFBSTtZQUVsQjtZQUVBLElBQUksQ0FBQzJCLFFBQVFHLFNBQVMsRUFBRTtnQkFDdEIsT0FBT3JELGtGQUFZQSxDQUFDcUIsSUFBSSxDQUN0QjtvQkFBRUMsT0FBTyxDQUFDLFFBQVEsRUFBRTRCLFFBQVFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQztnQkFBQyxHQUNyRDtvQkFBRS9CLFFBQVE7Z0JBQUk7WUFFbEI7WUFFQSxpQkFBaUI7WUFDakIsSUFBSSxPQUFPMkIsUUFBUUssS0FBSyxLQUFLLFlBQVlMLFFBQVFLLEtBQUssR0FBR2QsS0FBS2UsUUFBUSxFQUFFO2dCQUN0RSxPQUFPeEQsa0ZBQVlBLENBQUNxQixJQUFJLENBQUM7b0JBQUVDLE9BQU8sQ0FBQyx1QkFBdUIsRUFBRTRCLFFBQVFJLEtBQUssQ0FBQyxDQUFDO2dCQUFDLEdBQUc7b0JBQUUvQixRQUFRO2dCQUFJO1lBQy9GO1lBRUEsdURBQXVEO1lBQ3ZELE1BQU1rQyxjQUFjLE9BQU9QLFFBQVFRLFFBQVEsS0FBSyxXQUFXUixRQUFRUSxRQUFRLEdBQUc7WUFDOUUsTUFBTUMsaUJBQWlCQyxLQUFLQyxLQUFLLENBQUMsUUFBU0MsS0FBSyxHQUFJLEtBQUlMLGNBQWMsR0FBRSxLQUFPO1lBRS9FLE1BQU1NLFlBQVlKLGlCQUFpQmxCLEtBQUtlLFFBQVE7WUFDaEQsTUFBTVEsb0JBQW9CLENBQUNkLFFBQVFZLEtBQUssSUFBSSxLQUFLckIsS0FBS2UsUUFBUTtZQUM5RFQsWUFBWWdCO1lBQ1pmLGlCQUFpQlksS0FBS0ssR0FBRyxDQUFDLEdBQUdELG9CQUFvQkQ7WUFFakRkLFdBQVdpQixJQUFJLENBQUM7Z0JBQ2Q3QixXQUFXYSxRQUFRWCxHQUFHO2dCQUN0QjRCLE1BQU1qQixRQUFRSSxLQUFLLElBQUlKLFFBQVFpQixJQUFJO2dCQUNuQ0MsT0FBT3JDLE1BQU1DLE9BQU8sQ0FBQ2tCLFFBQVFtQixNQUFNLElBQzlCLE9BQU9uQixRQUFRbUIsTUFBTSxDQUFDLEVBQUUsS0FBSyxXQUFXbkIsUUFBUW1CLE1BQU0sQ0FBQyxFQUFFLEdBQUduQixRQUFRbUIsTUFBTSxDQUFDLEVBQUUsRUFBRUMsT0FBTyxLQUN0RnBCLFFBQVFxQixTQUFTLElBQUk7Z0JBQzFCVCxPQUFPSDtnQkFDUGEsZUFBZXRCLFFBQVFZLEtBQUs7Z0JBQzVCSixVQUFVRDtnQkFDVkQsVUFBVWYsS0FBS2UsUUFBUTtnQkFDdkJpQixLQUFLdkIsUUFBUXVCLEdBQUc7Z0JBQ2hCQyxjQUFjakMsS0FBS2lDLFlBQVksSUFBSTtZQUNyQztRQUNGO1FBRUEscUVBQXFFO1FBQ3JFLElBQUlDLGVBQWUsS0FBSyxtQkFBbUI7UUFDM0MsSUFBSUMsYUFBYSxJQUFJLGtCQUFrQjtRQUN2QyxJQUFJQyxnQkFBZ0IsR0FBRyxVQUFVO1FBRWpDLElBQUkvQyxnQkFBZ0I7WUFDbEIsTUFBTWdELG9CQUFvQixNQUFNeEUsd0RBQVFBLENBQUN5RSxPQUFPLENBQUM7Z0JBQy9DWixNQUFNckM7Z0JBQ05rRCxVQUFVO1lBQ1o7WUFFQSxJQUFJRixtQkFBbUI7Z0JBQ3JCSCxlQUFlRyxrQkFBa0JHLElBQUksSUFBSTtnQkFDekNMLGFBQWFFLGtCQUFrQkYsVUFBVSxJQUFJO2dCQUM3QyxJQUFJRSxrQkFBa0JELGFBQWEsRUFBRTtvQkFDbkMsSUFBSSxPQUFPQyxrQkFBa0JELGFBQWEsS0FBSyxZQUFZQyxrQkFBa0JELGFBQWEsQ0FBQ1osR0FBRyxFQUFFO3dCQUM5RlksZ0JBQWdCQyxrQkFBa0JELGFBQWEsQ0FBQ1osR0FBRztvQkFDckQsT0FBTyxJQUFJLE9BQU9hLGtCQUFrQkQsYUFBYSxLQUFLLFVBQVU7d0JBQzlEQSxnQkFBZ0JDLGtCQUFrQkQsYUFBYTtvQkFDakQ7Z0JBQ0Y7WUFDRjtRQUNGO1FBRUEsZ0RBQWdEO1FBQ2hELE1BQU1LLE1BQU10QixLQUFLQyxLQUFLLENBQUMsQ0FBQ2QsV0FBVzRCLFlBQVcsSUFBS0MsYUFBYTtRQUNoRSxNQUFNTyxRQUFRdkIsS0FBS0MsS0FBSyxDQUFDLENBQUNkLFdBQVc0QixlQUFlTyxNQUFNbEMsYUFBWSxJQUFLLE1BQU0sbUJBQW1CO1FBRXBHLDZDQUE2QztRQUM3QyxNQUFNb0MsUUFBUSxJQUFJL0UscURBQUtBLENBQUM7WUFDdEJnRixRQUFRakUsUUFBUWtFLElBQUksQ0FBQ2hELEVBQUU7WUFDdkJiLE9BQU93QjtZQUNQRjtZQUNBbUM7WUFDQXZELFVBQVVnRDtZQUNWakIsVUFBVVY7WUFDVm1DLE9BQVFwQyxXQUFXNEIsZUFBZU8sTUFBTWxDO1lBQ3hDdUMsVUFBVTtZQUNWQyxlQUFlO1lBQ2ZqRSxRQUFRO1lBQ1JHLGlCQUFpQkMsWUFBWUQ7WUFDN0JHLGdCQUFnQkEsa0JBQWtCRixZQUFZRDtZQUM5Q0ksZ0JBQWdCO2dCQUNkcUMsTUFBTXJDO2dCQUNOK0MsZUFBZUE7WUFDakI7UUFDRjtRQUVBLE1BQU1PLE1BQU1LLElBQUk7UUFFaEIsd0JBQXdCO1FBQ3hCLE1BQU1DLHVCQUF1QjtZQUMzQkMsUUFBUVI7WUFDUkksVUFBVTtZQUNWSyxTQUFTUixNQUFNUyxXQUFXLElBQUlULE1BQU03QyxHQUFHLENBQUNhLFFBQVE7WUFDaEQwQyxPQUFPO2dCQUNMQyxTQUFTWCxNQUFNN0MsR0FBRyxDQUFDYSxRQUFRO2dCQUMzQmlDLFFBQVFqRSxRQUFRa0UsSUFBSSxDQUFDaEQsRUFBRTtnQkFDdkJYLFVBQVVxRSxLQUFLQyxTQUFTLENBQUN0RSxZQUFZLENBQUM7WUFDeEM7UUFDRjtRQUVBLE1BQU11RSxnQkFBZ0IsTUFBTXhGLFNBQVN5RixNQUFNLENBQUNDLE1BQU0sQ0FBQ1Y7UUFFbkQsc0NBQXNDO1FBQ3RDTixNQUFNaUIsZUFBZSxHQUFHSCxjQUFjNUQsRUFBRTtRQUN4QyxNQUFNOEMsTUFBTUssSUFBSTtRQUVoQixvQ0FBb0M7UUFDcEMsT0FBT3pGLGtGQUFZQSxDQUFDcUIsSUFBSSxDQUFDO1lBQ3ZCMEUsU0FBU1gsTUFBTTdDLEdBQUcsQ0FBQ2EsUUFBUTtZQUMzQmlELGlCQUFpQkgsY0FBYzVELEVBQUU7WUFDakNxRCxRQUFRUjtZQUNSSSxVQUFVO1lBQ1ZlLEtBQUsxRixRQUFRQyxHQUFHLENBQUNDLGVBQWU7UUFDbEM7SUFDRixFQUFFLE9BQU9RLE9BQU87UUFDZGlGLFFBQVFqRixLQUFLLENBQUMsa0NBQWtDQTtRQUVoRCxrQ0FBa0M7UUFDbEMsSUFBSUEsTUFBTWtGLFVBQVUsS0FBSyxLQUFLO1lBQzVCLE9BQU94RyxrRkFBWUEsQ0FBQ3FCLElBQUksQ0FDdEI7Z0JBQ0VDLE9BQU9BLE1BQU1BLEtBQUssRUFBRW1GLGVBQWU7Z0JBQ25DQyxTQUFTcEYsTUFBTUEsS0FBSyxFQUFFcUYsUUFBUSxDQUFDLGVBQWUsRUFBRXJGLE1BQU1BLEtBQUssQ0FBQ3FGLEtBQUssQ0FBQyxDQUFDLEdBQUdDO1lBQ3hFLEdBQ0E7Z0JBQUVyRixRQUFRO1lBQUk7UUFFbEI7UUFFQSxJQUFJRCxNQUFNa0YsVUFBVSxLQUFLLEtBQUs7WUFDNUIsT0FBT3hHLGtGQUFZQSxDQUFDcUIsSUFBSSxDQUN0QjtnQkFDRUMsT0FBTztZQUNULEdBQ0E7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE9BQU92QixrRkFBWUEsQ0FBQ3FCLElBQUksQ0FDdEI7WUFDRUMsT0FBT0EsTUFBTXVGLE9BQU8sSUFBSTtZQUN4QkgsU0FBUzlGLEtBQXlCLEdBQWdCVSxNQUFNd0YsS0FBSyxHQUFHRixDQUFTQTtRQUMzRSxHQUNBO1lBQUVyRixRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25pcnZhYW5hYS1lY29tbWVyY2UvLi9hcHAvYXBpL3BheW1lbnQtaW50ZW50L3JvdXRlLmpzPzE2MzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gJ25leHQtYXV0aCc7XG5pbXBvcnQgeyBhdXRoT3B0aW9ucyB9IGZyb20gJ0AvbGliL2F1dGgnO1xuaW1wb3J0IGRiQ29ubmVjdCBmcm9tICdAL2xpYi9tb25nb2RiJztcbmltcG9ydCBQcm9kdWN0IGZyb20gJ0AvbW9kZWxzL1Byb2R1Y3QnO1xuaW1wb3J0IE9yZGVyIGZyb20gJ0AvbW9kZWxzL09yZGVyJztcbmltcG9ydCBTaGlwcGluZyBmcm9tICdAL21vZGVscy9TaGlwcGluZyc7XG5pbXBvcnQgUmF6b3JwYXkgZnJvbSAncmF6b3JwYXknO1xuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuaW1wb3J0IHsgcmF0ZUxpbWl0IH0gZnJvbSAnQC9saWIvcmF0ZUxpbWl0JztcblxuLy8gSW5pdGlhbGl6ZSBSYXpvcnBheSBjbGllbnRcbmNvbnN0IHJhem9ycGF5ID0gbmV3IFJhem9ycGF5KHtcbiAga2V5X2lkOiBwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfSUQsXG4gIGtleV9zZWNyZXQ6IHByb2Nlc3MuZW52LlJBWk9SUEFZX0tFWV9TRUNSRVQsXG59KTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgUmF6b3JwYXkgb3JkZXIgZm9yIHRoZSBjaGVja291dFxuICogU3VwcG9ydHMgVVBJLCBjYXJkcywgd2FsbGV0cywgYW5kIG90aGVyIHBheW1lbnQgbWV0aG9kc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0KSB7XG4gIC8vIEFwcGx5IHJhdGUgbGltaXRpbmdcbiAgY29uc3QgcmF0ZUxpbWl0UmVzcG9uc2UgPSBhd2FpdCByYXRlTGltaXQocmVxdWVzdCwgJ3BheW1lbnQnKTtcbiAgaWYgKHJhdGVMaW1pdFJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIHJhdGVMaW1pdFJlc3BvbnNlO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2VydmVyU2Vzc2lvbihhdXRoT3B0aW9ucyk7XG4gICAgXG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghcHJvY2Vzcy5lbnYuUkFaT1JQQVlfS0VZX0lEIHx8ICFwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfU0VDUkVUKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdSYXpvcnBheSBpcyBub3QgY29uZmlndXJlZC4gUGxlYXNlIGFkZCBSQVpPUlBBWV9LRVlfSUQgYW5kIFJBWk9SUEFZX0tFWV9TRUNSRVQgdG8geW91ciBlbnZpcm9ubWVudCB2YXJpYWJsZXMuJyB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHsgaXRlbXMsIHNoaXBwaW5nQWRkcmVzcywgc2hpcHBpbmc6IHNoaXBwaW5nQm9keSwgYmlsbGluZ0FkZHJlc3MsIHNoaXBwaW5nTWV0aG9kID0gJ1N0YW5kYXJkIFNoaXBwaW5nJyB9ID0gYm9keTtcblxuICAgIC8vIEFjY2VwdCBlaXRoZXIgc2hpcHBpbmdBZGRyZXNzIG9yIHNoaXBwaW5nXG4gICAgY29uc3Qgc2hpcHBpbmcgPSBzaGlwcGluZ0FkZHJlc3MgfHwgc2hpcHBpbmdCb2R5O1xuXG4gICAgaWYgKCFpdGVtcyB8fCAhQXJyYXkuaXNBcnJheShpdGVtcykgfHwgaXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0NhcnQgaXRlbXMgYXJlIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIGlmICghc2hpcHBpbmcpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnU2hpcHBpbmcgYWRkcmVzcyBpcyByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICB9XG5cbiAgICAvLyBOb3JtYWxpemUgaW5jb21pbmcgaXRlbSByZWZlcmVuY2VzIHRvIHByb2R1Y3RJZFxuICAgIGNvbnN0IG5vcm1hbGl6ZWRJdGVtcyA9IGl0ZW1zLm1hcChpID0+ICh7XG4gICAgICAuLi5pLFxuICAgICAgcHJvZHVjdElkOiBpLnByb2R1Y3RJZCB8fCBpLmlkIHx8IGkuX2lkLFxuICAgIH0pKTtcblxuICAgIGNvbnN0IHByb2R1Y3RJZHMgPSBub3JtYWxpemVkSXRlbXMubWFwKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQpLmZpbHRlcihCb29sZWFuKTtcbiAgICBpZiAocHJvZHVjdElkcy5sZW5ndGggIT09IG5vcm1hbGl6ZWRJdGVtcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnSW52YWxpZCBjYXJ0IGl0ZW1zJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdC5maW5kKHsgX2lkOiB7ICRpbjogcHJvZHVjdElkcyB9IH0pO1xuXG4gICAgaWYgKHByb2R1Y3RzLmxlbmd0aCAhPT0gcHJvZHVjdElkcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnU29tZSBwcm9kdWN0cyBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHRvdGFscyBhbmQgdmFsaWRhdGUgc3RvY2tcbiAgICBsZXQgc3VidG90YWwgPSAwOyAvLyBpbiBydXBlZXNcbiAgICBsZXQgdG90YWxEaXNjb3VudCA9IDA7IC8vIGluIHJ1cGVlc1xuICAgIGNvbnN0IG9yZGVySXRlbXMgPSBbXTtcblxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBub3JtYWxpemVkSXRlbXMpIHtcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBwcm9kdWN0cy5maW5kKHAgPT4gcC5faWQudG9TdHJpbmcoKSA9PT0gaXRlbS5wcm9kdWN0SWQpO1xuXG4gICAgICBpZiAoIXByb2R1Y3QpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgZXJyb3I6IGBQcm9kdWN0ICR7aXRlbS5wcm9kdWN0SWR9IG5vdCBmb3VuZGAgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFwcm9kdWN0LnB1Ymxpc2hlZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogYFByb2R1Y3QgJHtwcm9kdWN0LnRpdGxlfSBpcyBub3QgYXZhaWxhYmxlYCB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBzdG9ja1xuICAgICAgaWYgKHR5cGVvZiBwcm9kdWN0LnN0b2NrID09PSAnbnVtYmVyJyAmJiBwcm9kdWN0LnN0b2NrIDwgaXRlbS5xdWFudGl0eSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogYEluc3VmZmljaWVudCBzdG9jayBmb3IgJHtwcm9kdWN0LnRpdGxlfWAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29tcHV0ZSBlZmZlY3RpdmUgcHJpY2UgYWZ0ZXIgcHJvZHVjdC1sZXZlbCBkaXNjb3VudFxuICAgICAgY29uc3QgZGlzY291bnRQY3QgPSB0eXBlb2YgcHJvZHVjdC5kaXNjb3VudCA9PT0gJ251bWJlcicgPyBwcm9kdWN0LmRpc2NvdW50IDogMDtcbiAgICAgIGNvbnN0IGVmZmVjdGl2ZVByaWNlID0gTWF0aC5yb3VuZCgocHJvZHVjdC5wcmljZSAqICgxIC0gZGlzY291bnRQY3QgLyAxMDApKSB8fCAwKTtcblxuICAgICAgY29uc3QgaXRlbVRvdGFsID0gZWZmZWN0aXZlUHJpY2UgKiBpdGVtLnF1YW50aXR5O1xuICAgICAgY29uc3QgaXRlbU9yaWdpbmFsVG90YWwgPSAocHJvZHVjdC5wcmljZSB8fCAwKSAqIGl0ZW0ucXVhbnRpdHk7XG4gICAgICBzdWJ0b3RhbCArPSBpdGVtVG90YWw7XG4gICAgICB0b3RhbERpc2NvdW50ICs9IE1hdGgubWF4KDAsIGl0ZW1PcmlnaW5hbFRvdGFsIC0gaXRlbVRvdGFsKTtcblxuICAgICAgb3JkZXJJdGVtcy5wdXNoKHtcbiAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0Ll9pZCxcbiAgICAgICAgbmFtZTogcHJvZHVjdC50aXRsZSB8fCBwcm9kdWN0Lm5hbWUsXG4gICAgICAgIGltYWdlOiBBcnJheS5pc0FycmF5KHByb2R1Y3QuaW1hZ2VzKSBcbiAgICAgICAgICA/ICh0eXBlb2YgcHJvZHVjdC5pbWFnZXNbMF0gPT09ICdzdHJpbmcnID8gcHJvZHVjdC5pbWFnZXNbMF0gOiBwcm9kdWN0LmltYWdlc1swXT8udXJsIHx8ICcnKSBcbiAgICAgICAgICA6IChwcm9kdWN0Lm1haW5JbWFnZSB8fCAnJyksXG4gICAgICAgIHByaWNlOiBlZmZlY3RpdmVQcmljZSxcbiAgICAgICAgb3JpZ2luYWxQcmljZTogcHJvZHVjdC5wcmljZSxcbiAgICAgICAgZGlzY291bnQ6IGRpc2NvdW50UGN0LFxuICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgc2t1OiBwcm9kdWN0LnNrdSxcbiAgICAgICAgY29sb3JWYXJpYW50OiBpdGVtLmNvbG9yVmFyaWFudCB8fCBudWxsLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHNoaXBwaW5nIGFuZCB0YXggLSBsb29rIHVwIHNoaXBwaW5nIG1ldGhvZCBmcm9tIGRhdGFiYXNlXG4gICAgbGV0IHNoaXBwaW5nQ29zdCA9IDEwMDsgLy8gRGVmYXVsdCBmYWxsYmFja1xuICAgIGxldCBnc3RQZXJjZW50ID0gMTg7IC8vIERlZmF1bHQgMTglIEdTVFxuICAgIGxldCBlc3RpbWF0ZWREYXlzID0gNTsgLy8gRGVmYXVsdFxuICAgIFxuICAgIGlmIChzaGlwcGluZ01ldGhvZCkge1xuICAgICAgY29uc3Qgc2hpcHBpbmdNZXRob2REb2MgPSBhd2FpdCBTaGlwcGluZy5maW5kT25lKHsgXG4gICAgICAgIG5hbWU6IHNoaXBwaW5nTWV0aG9kLFxuICAgICAgICBpc0FjdGl2ZTogdHJ1ZSBcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoc2hpcHBpbmdNZXRob2REb2MpIHtcbiAgICAgICAgc2hpcHBpbmdDb3N0ID0gc2hpcHBpbmdNZXRob2REb2MuY29zdCB8fCAxMDA7XG4gICAgICAgIGdzdFBlcmNlbnQgPSBzaGlwcGluZ01ldGhvZERvYy5nc3RQZXJjZW50IHx8IDE4O1xuICAgICAgICBpZiAoc2hpcHBpbmdNZXRob2REb2MuZXN0aW1hdGVkRGF5cykge1xuICAgICAgICAgIGlmICh0eXBlb2Ygc2hpcHBpbmdNZXRob2REb2MuZXN0aW1hdGVkRGF5cyA9PT0gJ29iamVjdCcgJiYgc2hpcHBpbmdNZXRob2REb2MuZXN0aW1hdGVkRGF5cy5tYXgpIHtcbiAgICAgICAgICAgIGVzdGltYXRlZERheXMgPSBzaGlwcGluZ01ldGhvZERvYy5lc3RpbWF0ZWREYXlzLm1heDtcbiAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBzaGlwcGluZ01ldGhvZERvYy5lc3RpbWF0ZWREYXlzID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgZXN0aW1hdGVkRGF5cyA9IHNoaXBwaW5nTWV0aG9kRG9jLmVzdGltYXRlZERheXM7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFRheCBpcyBjYWxjdWxhdGVkIG9uIHN1YnRvdGFsICsgc2hpcHBpbmcgY29zdFxuICAgIGNvbnN0IHRheCA9IE1hdGgucm91bmQoKHN1YnRvdGFsICsgc2hpcHBpbmdDb3N0KSAqIGdzdFBlcmNlbnQgLyAxMDApO1xuICAgIGNvbnN0IHRvdGFsID0gTWF0aC5yb3VuZCgoc3VidG90YWwgKyBzaGlwcGluZ0Nvc3QgKyB0YXggLSB0b3RhbERpc2NvdW50KSAqIDEwMCk7IC8vIENvbnZlcnQgdG8gcGFpc2VcblxuICAgIC8vIENyZWF0ZSBvcmRlciBpbiBkYXRhYmFzZSAocGVuZGluZyBwYXltZW50KVxuICAgIGNvbnN0IG9yZGVyID0gbmV3IE9yZGVyKHtcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgaXRlbXM6IG9yZGVySXRlbXMsXG4gICAgICBzdWJ0b3RhbCxcbiAgICAgIHRheCxcbiAgICAgIHNoaXBwaW5nOiBzaGlwcGluZ0Nvc3QsXG4gICAgICBkaXNjb3VudDogdG90YWxEaXNjb3VudCxcbiAgICAgIHRvdGFsOiAoc3VidG90YWwgKyBzaGlwcGluZ0Nvc3QgKyB0YXggLSB0b3RhbERpc2NvdW50KSxcbiAgICAgIGN1cnJlbmN5OiAnSU5SJyxcbiAgICAgIHBheW1lbnRNZXRob2Q6ICdyYXpvcnBheScsXG4gICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgIHNoaXBwaW5nQWRkcmVzczogc2hpcHBpbmcgfHwgc2hpcHBpbmdBZGRyZXNzLFxuICAgICAgYmlsbGluZ0FkZHJlc3M6IGJpbGxpbmdBZGRyZXNzIHx8IHNoaXBwaW5nIHx8IHNoaXBwaW5nQWRkcmVzcyxcbiAgICAgIHNoaXBwaW5nTWV0aG9kOiB7XG4gICAgICAgIG5hbWU6IHNoaXBwaW5nTWV0aG9kLFxuICAgICAgICBlc3RpbWF0ZWREYXlzOiBlc3RpbWF0ZWREYXlzLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGF3YWl0IG9yZGVyLnNhdmUoKTtcblxuICAgIC8vIENyZWF0ZSBSYXpvcnBheSBvcmRlclxuICAgIGNvbnN0IHJhem9ycGF5T3JkZXJPcHRpb25zID0ge1xuICAgICAgYW1vdW50OiB0b3RhbCwgLy8gQW1vdW50IGluIHBhaXNlXG4gICAgICBjdXJyZW5jeTogJ0lOUicsXG4gICAgICByZWNlaXB0OiBvcmRlci5vcmRlck51bWJlciB8fCBvcmRlci5faWQudG9TdHJpbmcoKSxcbiAgICAgIG5vdGVzOiB7XG4gICAgICAgIG9yZGVySWQ6IG9yZGVyLl9pZC50b1N0cmluZygpLFxuICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgc2hpcHBpbmc6IEpTT04uc3RyaW5naWZ5KHNoaXBwaW5nIHx8IHt9KSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIGNvbnN0IHJhem9ycGF5T3JkZXIgPSBhd2FpdCByYXpvcnBheS5vcmRlcnMuY3JlYXRlKHJhem9ycGF5T3JkZXJPcHRpb25zKTtcblxuICAgIC8vIFVwZGF0ZSBvcmRlciB3aXRoIFJhem9ycGF5IG9yZGVyIElEXG4gICAgb3JkZXIucmF6b3JwYXlPcmRlcklkID0gcmF6b3JwYXlPcmRlci5pZDtcbiAgICBhd2FpdCBvcmRlci5zYXZlKCk7XG5cbiAgICAvLyBSZXR1cm4gb3JkZXIgZGV0YWlscyBmb3IgZnJvbnRlbmRcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgb3JkZXJJZDogb3JkZXIuX2lkLnRvU3RyaW5nKCksXG4gICAgICByYXpvcnBheU9yZGVySWQ6IHJhem9ycGF5T3JkZXIuaWQsXG4gICAgICBhbW91bnQ6IHRvdGFsLFxuICAgICAgY3VycmVuY3k6ICdJTlInLFxuICAgICAga2V5OiBwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfSUQsIC8vIFB1YmxpYyBrZXkgZm9yIGZyb250ZW5kXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignUmF6b3JwYXkgb3JkZXIgY3JlYXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgIFxuICAgIC8vIEhhbmRsZSBzcGVjaWZpYyBSYXpvcnBheSBlcnJvcnNcbiAgICBpZiAoZXJyb3Iuc3RhdHVzQ29kZSA9PT0gNDAwKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgXG4gICAgICAgICAgZXJyb3I6IGVycm9yLmVycm9yPy5kZXNjcmlwdGlvbiB8fCAnSW52YWxpZCBwYXltZW50IHJlcXVlc3QnLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLmVycm9yPy5maWVsZCA/IGBJbnZhbGlkIGZpZWxkOiAke2Vycm9yLmVycm9yLmZpZWxkfWAgOiB1bmRlZmluZWRcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICBpZiAoZXJyb3Iuc3RhdHVzQ29kZSA9PT0gNDAxKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgXG4gICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIFJhem9ycGF5IGNyZWRlbnRpYWxzLiBQbGVhc2UgY2hlY2sgeW91ciBBUEkga2V5cy4nLFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gY3JlYXRlIHBheW1lbnQgb3JkZXInLFxuICAgICAgICBkZXRhaWxzOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkXG4gICAgICB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldFNlcnZlclNlc3Npb24iLCJhdXRoT3B0aW9ucyIsImRiQ29ubmVjdCIsIlByb2R1Y3QiLCJPcmRlciIsIlNoaXBwaW5nIiwiUmF6b3JwYXkiLCJjcnlwdG8iLCJyYXRlTGltaXQiLCJyYXpvcnBheSIsImtleV9pZCIsInByb2Nlc3MiLCJlbnYiLCJSQVpPUlBBWV9LRVlfSUQiLCJrZXlfc2VjcmV0IiwiUkFaT1JQQVlfS0VZX1NFQ1JFVCIsIlBPU1QiLCJyZXF1ZXN0IiwicmF0ZUxpbWl0UmVzcG9uc2UiLCJzZXNzaW9uIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiYm9keSIsIml0ZW1zIiwic2hpcHBpbmdBZGRyZXNzIiwic2hpcHBpbmciLCJzaGlwcGluZ0JvZHkiLCJiaWxsaW5nQWRkcmVzcyIsInNoaXBwaW5nTWV0aG9kIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwibm9ybWFsaXplZEl0ZW1zIiwibWFwIiwiaSIsInByb2R1Y3RJZCIsImlkIiwiX2lkIiwicHJvZHVjdElkcyIsIml0ZW0iLCJmaWx0ZXIiLCJCb29sZWFuIiwicHJvZHVjdHMiLCJmaW5kIiwiJGluIiwic3VidG90YWwiLCJ0b3RhbERpc2NvdW50Iiwib3JkZXJJdGVtcyIsInByb2R1Y3QiLCJwIiwidG9TdHJpbmciLCJwdWJsaXNoZWQiLCJ0aXRsZSIsInN0b2NrIiwicXVhbnRpdHkiLCJkaXNjb3VudFBjdCIsImRpc2NvdW50IiwiZWZmZWN0aXZlUHJpY2UiLCJNYXRoIiwicm91bmQiLCJwcmljZSIsIml0ZW1Ub3RhbCIsIml0ZW1PcmlnaW5hbFRvdGFsIiwibWF4IiwicHVzaCIsIm5hbWUiLCJpbWFnZSIsImltYWdlcyIsInVybCIsIm1haW5JbWFnZSIsIm9yaWdpbmFsUHJpY2UiLCJza3UiLCJjb2xvclZhcmlhbnQiLCJzaGlwcGluZ0Nvc3QiLCJnc3RQZXJjZW50IiwiZXN0aW1hdGVkRGF5cyIsInNoaXBwaW5nTWV0aG9kRG9jIiwiZmluZE9uZSIsImlzQWN0aXZlIiwiY29zdCIsInRheCIsInRvdGFsIiwib3JkZXIiLCJ1c2VySWQiLCJ1c2VyIiwiY3VycmVuY3kiLCJwYXltZW50TWV0aG9kIiwic2F2ZSIsInJhem9ycGF5T3JkZXJPcHRpb25zIiwiYW1vdW50IiwicmVjZWlwdCIsIm9yZGVyTnVtYmVyIiwibm90ZXMiLCJvcmRlcklkIiwiSlNPTiIsInN0cmluZ2lmeSIsInJhem9ycGF5T3JkZXIiLCJvcmRlcnMiLCJjcmVhdGUiLCJyYXpvcnBheU9yZGVySWQiLCJrZXkiLCJjb25zb2xlIiwic3RhdHVzQ29kZSIsImRlc2NyaXB0aW9uIiwiZGV0YWlscyIsImZpZWxkIiwidW5kZWZpbmVkIiwibWVzc2FnZSIsInN0YWNrIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/payment-intent/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/auth.js":
/*!*********************!*\
  !*** ./lib/auth.js ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/facebook */ \"(rsc)/./node_modules/next-auth/providers/facebook.js\");\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/mongodb */ \"(rsc)/./lib/mongodb.js\");\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/models/User */ \"(rsc)/./models/User.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            name: \"credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) {\n                    throw new Error(\"Email and password are required\");\n                }\n                await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n                const user = await _models_User__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findOne({\n                    email: credentials.email\n                });\n                if (!user) {\n                    throw new Error(\"Invalid email or password\");\n                }\n                if (!user.passwordHash) {\n                    throw new Error(\"Please sign in with your social account\");\n                }\n                // Inside authorize\n                const isValidPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_5___default().compare(credentials.password, user.passwordHash);\n                if (!isValidPassword) {\n                    throw new Error(\"Invalid email or password\");\n                }\n                if (!user.isActive) {\n                    throw new Error(\"Account is deactivated\");\n                }\n                return {\n                    id: user._id.toString(),\n                    name: user.name,\n                    email: user.email,\n                    role: user.role,\n                    image: user.image\n                };\n            }\n        }),\n        (0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            clientId: process.env.GOOGLE_CLIENT_ID,\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET\n        }),\n        (0,next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n            clientId: process.env.FACEBOOK_CLIENT_ID,\n            clientSecret: process.env.FACEBOOK_CLIENT_SECRET\n        })\n    ],\n    callbacks: {\n        async signIn ({ user, account, profile }) {\n            if (account?.provider === \"google\" || account?.provider === \"facebook\") {\n                await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n                const existingUser = await _models_User__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findOne({\n                    $or: [\n                        {\n                            email: user.email\n                        },\n                        {\n                            googleId: account.provider === \"google\" ? profile.sub : null\n                        },\n                        {\n                            facebookId: account.provider === \"facebook\" ? profile.id : null\n                        }\n                    ]\n                });\n                if (existingUser) {\n                    // Update social IDs if not present\n                    if (account.provider === \"google\" && !existingUser.googleId) {\n                        existingUser.googleId = profile.sub;\n                        existingUser.image = user.image;\n                        await existingUser.save();\n                    } else if (account.provider === \"facebook\" && !existingUser.facebookId) {\n                        existingUser.facebookId = profile.id;\n                        existingUser.image = user.image;\n                        await existingUser.save();\n                    }\n                    return existingUser.isActive;\n                } else {\n                    // Create new user\n                    const newUser = new _models_User__WEBPACK_IMPORTED_MODULE_4__[\"default\"]({\n                        name: user.name,\n                        email: user.email,\n                        image: user.image,\n                        googleId: account.provider === \"google\" ? profile.sub : null,\n                        facebookId: account.provider === \"facebook\" ? profile.id : null,\n                        emailVerified: true\n                    });\n                    await newUser.save();\n                    return true;\n                }\n            }\n            // track lastLogin for real-time KPI customer activity\n            try {\n                await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n                const dbUser = await _models_User__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findOne({\n                    email: user.email\n                });\n                if (dbUser) {\n                    dbUser.lastLogin = new Date();\n                    await dbUser.save();\n                }\n            } catch (e) {}\n            return true;\n        },\n        async jwt ({ token, user, account }) {\n            if (user) {\n                token.role = user.role;\n                token.id = user.id;\n                // Set shorter expiry for admin users (2 hours)\n                if (user.role === \"admin\") {\n                    token.maxAge = 2 * 60 * 60; // 2 hours in seconds\n                }\n            }\n            if (account?.provider === \"google\" || account?.provider === \"facebook\") {\n                await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n                const dbUser = await _models_User__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findOne({\n                    email: token.email\n                });\n                if (dbUser) {\n                    token.role = dbUser.role;\n                    token.id = dbUser._id.toString();\n                    // Set shorter expiry for admin users (2 hours)\n                    if (dbUser.role === \"admin\") {\n                        token.maxAge = 2 * 60 * 60; // 2 hours in seconds\n                    }\n                }\n            }\n            // Check if admin token has expired\n            if (token.role === \"admin\" && token.maxAge) {\n                const now = Math.floor(Date.now() / 1000);\n                const issuedAt = token.iat || now;\n                if (now - issuedAt > token.maxAge) {\n                    // Token expired for admin\n                    return null;\n                }\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token) {\n                session.user.id = token.id;\n                session.user.role = token.role;\n                // Verify admin role on every request (server-side check)\n                if (token.role === \"admin\") {\n                    await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n                    const dbUser = await _models_User__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findById(token.id);\n                    if (!dbUser || dbUser.role !== \"admin\" || !dbUser.isActive) {\n                        // Revoke admin access if role changed or user deactivated\n                        session.user.role = \"user\";\n                    }\n                }\n            }\n            return session;\n        }\n    },\n    pages: {\n        signIn: \"/auth/signin\",\n        error: \"/auth/error\"\n    },\n    session: {\n        strategy: \"jwt\",\n        maxAge: 30 * 24 * 60 * 60\n    },\n    cookies: {\n        sessionToken: {\n            name: `next-auth.session-token`,\n            options: {\n                httpOnly: true,\n                sameSite: \"lax\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        },\n        callbackUrl: {\n            name: `next-auth.callback-url`,\n            options: {\n                httpOnly: true,\n                sameSite: \"lax\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        },\n        csrfToken: {\n            name: `next-auth.csrf-token`,\n            options: {\n                httpOnly: true,\n                sameSite: \"lax\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        }\n    },\n    secret: process.env.NEXTAUTH_SECRET,\n    debug: \"development\" === \"development\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxJQUFJLENBQUMwQixVQUFVQSxPQUFPdkIsSUFBSSxLQUFLLFdBQVcsQ0FBQ3VCLE9BQU8zQixRQUFRLEVBQUU7d0JBQzFELDBEQUEwRDt3QkFDMUR1QyxRQUFRNUMsSUFBSSxDQUFDUyxJQUFJLEdBQUc7b0JBQ3RCO2dCQUNGO1lBQ0Y7WUFDQSxPQUFPbUM7UUFDVDtJQUNGO0lBQ0FFLE9BQU87UUFDTDFCLFFBQVE7UUFDUjJCLE9BQU87SUFDVDtJQUNBSCxTQUFTO1FBQ1BJLFVBQVU7UUFDVlYsUUFBUSxLQUFLLEtBQUssS0FBSztJQUN6QjtJQUNBVyxTQUFTO1FBQ1BDLGNBQWM7WUFDWjFELE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQztZQUMvQjJELFNBQVM7Z0JBQ1BDLFVBQVU7Z0JBQ1ZDLFVBQVU7Z0JBQ1ZDLE1BQU07Z0JBQ05DLFFBQVEzQyxrQkFBeUI7WUFDbkM7UUFDRjtRQUNBNEMsYUFBYTtZQUNYaEUsTUFBTSxDQUFDLHNCQUFzQixDQUFDO1lBQzlCMkQsU0FBUztnQkFDUEMsVUFBVTtnQkFDVkMsVUFBVTtnQkFDVkMsTUFBTTtnQkFDTkMsUUFBUTNDLGtCQUF5QjtZQUNuQztRQUNGO1FBQ0E2QyxXQUFXO1lBQ1RqRSxNQUFNLENBQUMsb0JBQW9CLENBQUM7WUFDNUIyRCxTQUFTO2dCQUNQQyxVQUFVO2dCQUNWQyxVQUFVO2dCQUNWQyxNQUFNO2dCQUNOQyxRQUFRM0Msa0JBQXlCO1lBQ25DO1FBQ0Y7SUFDRjtJQUNBOEMsUUFBUTlDLFFBQVFDLEdBQUcsQ0FBQzhDLGVBQWU7SUFDbkNDLE9BQU9oRCxrQkFBeUI7QUFDbEMsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL25pcnZhYW5hYS1lY29tbWVyY2UvLi9saWIvYXV0aC5qcz8yODdiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDcmVkZW50aWFsc1Byb3ZpZGVyIGZyb20gJ25leHQtYXV0aC9wcm92aWRlcnMvY3JlZGVudGlhbHMnO1xuaW1wb3J0IEdvb2dsZVByb3ZpZGVyIGZyb20gJ25leHQtYXV0aC9wcm92aWRlcnMvZ29vZ2xlJztcbmltcG9ydCBGYWNlYm9va1Byb3ZpZGVyIGZyb20gJ25leHQtYXV0aC9wcm92aWRlcnMvZmFjZWJvb2snO1xuaW1wb3J0IGRiQ29ubmVjdCBmcm9tICdAL2xpYi9tb25nb2RiJztcbmltcG9ydCBVc2VyIGZyb20gJ0AvbW9kZWxzL1VzZXInO1xuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcyc7XG5cbmV4cG9ydCBjb25zdCBhdXRoT3B0aW9ucyA9IHtcbiAgcHJvdmlkZXJzOiBbXG4gICAgQ3JlZGVudGlhbHNQcm92aWRlcih7XG4gICAgICBuYW1lOiAnY3JlZGVudGlhbHMnLFxuICAgICAgY3JlZGVudGlhbHM6IHtcbiAgICAgICAgZW1haWw6IHsgbGFiZWw6ICdFbWFpbCcsIHR5cGU6ICdlbWFpbCcgfSxcbiAgICAgICAgcGFzc3dvcmQ6IHsgbGFiZWw6ICdQYXNzd29yZCcsIHR5cGU6ICdwYXNzd29yZCcgfSxcbiAgICAgIH0sXG4gICAgICBhc3luYyBhdXRob3JpemUoY3JlZGVudGlhbHMpIHtcbiAgICAgICAgaWYgKCFjcmVkZW50aWFscz8uZW1haWwgfHwgIWNyZWRlbnRpYWxzPy5wYXNzd29yZCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRW1haWwgYW5kIHBhc3N3b3JkIGFyZSByZXF1aXJlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgZGJDb25uZWN0KCk7XG5cbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IGVtYWlsOiBjcmVkZW50aWFscy5lbWFpbCB9KTtcblxuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZW1haWwgb3IgcGFzc3dvcmQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdXNlci5wYXNzd29yZEhhc2gpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BsZWFzZSBzaWduIGluIHdpdGggeW91ciBzb2NpYWwgYWNjb3VudCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW5zaWRlIGF1dGhvcml6ZVxuICAgICAgICBjb25zdCBpc1ZhbGlkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShjcmVkZW50aWFscy5wYXNzd29yZCwgdXNlci5wYXNzd29yZEhhc2gpO1xuICAgICAgICBpZiAoIWlzVmFsaWRQYXNzd29yZCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF1c2VyLmlzQWN0aXZlKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBY2NvdW50IGlzIGRlYWN0aXZhdGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiB1c2VyLl9pZC50b1N0cmluZygpLFxuICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICByb2xlOiB1c2VyLnJvbGUsXG4gICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0pLFxuICAgIEdvb2dsZVByb3ZpZGVyKHtcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX0lELFxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX1NFQ1JFVCxcbiAgICB9KSxcbiAgICBGYWNlYm9va1Byb3ZpZGVyKHtcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5GQUNFQk9PS19DTElFTlRfSUQsXG4gICAgICBjbGllbnRTZWNyZXQ6IHByb2Nlc3MuZW52LkZBQ0VCT09LX0NMSUVOVF9TRUNSRVQsXG4gICAgfSksXG4gIF0sXG4gIGNhbGxiYWNrczoge1xuICAgIGFzeW5jIHNpZ25Jbih7IHVzZXIsIGFjY291bnQsIHByb2ZpbGUgfSkge1xuICAgICAgaWYgKGFjY291bnQ/LnByb3ZpZGVyID09PSAnZ29vZ2xlJyB8fCBhY2NvdW50Py5wcm92aWRlciA9PT0gJ2ZhY2Vib29rJykge1xuICAgICAgICBhd2FpdCBkYkNvbm5lY3QoKTtcblxuICAgICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoe1xuICAgICAgICAgICRvcjogW1xuICAgICAgICAgICAgeyBlbWFpbDogdXNlci5lbWFpbCB9LFxuICAgICAgICAgICAgeyBnb29nbGVJZDogYWNjb3VudC5wcm92aWRlciA9PT0gJ2dvb2dsZScgPyBwcm9maWxlLnN1YiA6IG51bGwgfSxcbiAgICAgICAgICAgIHsgZmFjZWJvb2tJZDogYWNjb3VudC5wcm92aWRlciA9PT0gJ2ZhY2Vib29rJyA/IHByb2ZpbGUuaWQgOiBudWxsIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGV4aXN0aW5nVXNlcikge1xuICAgICAgICAgIC8vIFVwZGF0ZSBzb2NpYWwgSURzIGlmIG5vdCBwcmVzZW50XG4gICAgICAgICAgaWYgKGFjY291bnQucHJvdmlkZXIgPT09ICdnb29nbGUnICYmICFleGlzdGluZ1VzZXIuZ29vZ2xlSWQpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nVXNlci5nb29nbGVJZCA9IHByb2ZpbGUuc3ViO1xuICAgICAgICAgICAgZXhpc3RpbmdVc2VyLmltYWdlID0gdXNlci5pbWFnZTtcbiAgICAgICAgICAgIGF3YWl0IGV4aXN0aW5nVXNlci5zYXZlKCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChhY2NvdW50LnByb3ZpZGVyID09PSAnZmFjZWJvb2snICYmICFleGlzdGluZ1VzZXIuZmFjZWJvb2tJZCkge1xuICAgICAgICAgICAgZXhpc3RpbmdVc2VyLmZhY2Vib29rSWQgPSBwcm9maWxlLmlkO1xuICAgICAgICAgICAgZXhpc3RpbmdVc2VyLmltYWdlID0gdXNlci5pbWFnZTtcbiAgICAgICAgICAgIGF3YWl0IGV4aXN0aW5nVXNlci5zYXZlKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGV4aXN0aW5nVXNlci5pc0FjdGl2ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBDcmVhdGUgbmV3IHVzZXJcbiAgICAgICAgICBjb25zdCBuZXdVc2VyID0gbmV3IFVzZXIoe1xuICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZSxcbiAgICAgICAgICAgIGdvb2dsZUlkOiBhY2NvdW50LnByb3ZpZGVyID09PSAnZ29vZ2xlJyA/IHByb2ZpbGUuc3ViIDogbnVsbCxcbiAgICAgICAgICAgIGZhY2Vib29rSWQ6IGFjY291bnQucHJvdmlkZXIgPT09ICdmYWNlYm9vaycgPyBwcm9maWxlLmlkIDogbnVsbCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBhd2FpdCBuZXdVc2VyLnNhdmUoKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyB0cmFjayBsYXN0TG9naW4gZm9yIHJlYWwtdGltZSBLUEkgY3VzdG9tZXIgYWN0aXZpdHlcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xuICAgICAgICBjb25zdCBkYlVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBlbWFpbDogdXNlci5lbWFpbCB9KTtcbiAgICAgICAgaWYgKGRiVXNlcikge1xuICAgICAgICAgIGRiVXNlci5sYXN0TG9naW4gPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgIGF3YWl0IGRiVXNlci5zYXZlKCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGFzeW5jIGp3dCh7IHRva2VuLCB1c2VyLCBhY2NvdW50IH0pIHtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIHRva2VuLnJvbGUgPSB1c2VyLnJvbGU7XG4gICAgICAgIHRva2VuLmlkID0gdXNlci5pZDtcbiAgICAgICAgLy8gU2V0IHNob3J0ZXIgZXhwaXJ5IGZvciBhZG1pbiB1c2VycyAoMiBob3VycylcbiAgICAgICAgaWYgKHVzZXIucm9sZSA9PT0gJ2FkbWluJykge1xuICAgICAgICAgIHRva2VuLm1heEFnZSA9IDIgKiA2MCAqIDYwOyAvLyAyIGhvdXJzIGluIHNlY29uZHNcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoYWNjb3VudD8ucHJvdmlkZXIgPT09ICdnb29nbGUnIHx8IGFjY291bnQ/LnByb3ZpZGVyID09PSAnZmFjZWJvb2snKSB7XG4gICAgICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xuICAgICAgICBjb25zdCBkYlVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBlbWFpbDogdG9rZW4uZW1haWwgfSk7XG4gICAgICAgIGlmIChkYlVzZXIpIHtcbiAgICAgICAgICB0b2tlbi5yb2xlID0gZGJVc2VyLnJvbGU7XG4gICAgICAgICAgdG9rZW4uaWQgPSBkYlVzZXIuX2lkLnRvU3RyaW5nKCk7XG4gICAgICAgICAgLy8gU2V0IHNob3J0ZXIgZXhwaXJ5IGZvciBhZG1pbiB1c2VycyAoMiBob3VycylcbiAgICAgICAgICBpZiAoZGJVc2VyLnJvbGUgPT09ICdhZG1pbicpIHtcbiAgICAgICAgICAgIHRva2VuLm1heEFnZSA9IDIgKiA2MCAqIDYwOyAvLyAyIGhvdXJzIGluIHNlY29uZHNcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgYWRtaW4gdG9rZW4gaGFzIGV4cGlyZWRcbiAgICAgIGlmICh0b2tlbi5yb2xlID09PSAnYWRtaW4nICYmIHRva2VuLm1heEFnZSkge1xuICAgICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcbiAgICAgICAgY29uc3QgaXNzdWVkQXQgPSB0b2tlbi5pYXQgfHwgbm93O1xuICAgICAgICBpZiAobm93IC0gaXNzdWVkQXQgPiB0b2tlbi5tYXhBZ2UpIHtcbiAgICAgICAgICAvLyBUb2tlbiBleHBpcmVkIGZvciBhZG1pblxuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0b2tlbjtcbiAgICB9LFxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XG4gICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkID0gdG9rZW4uaWQ7XG4gICAgICAgIHNlc3Npb24udXNlci5yb2xlID0gdG9rZW4ucm9sZTtcbiAgICAgICAgXG4gICAgICAgIC8vIFZlcmlmeSBhZG1pbiByb2xlIG9uIGV2ZXJ5IHJlcXVlc3QgKHNlcnZlci1zaWRlIGNoZWNrKVxuICAgICAgICBpZiAodG9rZW4ucm9sZSA9PT0gJ2FkbWluJykge1xuICAgICAgICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xuICAgICAgICAgIGNvbnN0IGRiVXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQodG9rZW4uaWQpO1xuICAgICAgICAgIGlmICghZGJVc2VyIHx8IGRiVXNlci5yb2xlICE9PSAnYWRtaW4nIHx8ICFkYlVzZXIuaXNBY3RpdmUpIHtcbiAgICAgICAgICAgIC8vIFJldm9rZSBhZG1pbiBhY2Nlc3MgaWYgcm9sZSBjaGFuZ2VkIG9yIHVzZXIgZGVhY3RpdmF0ZWRcbiAgICAgICAgICAgIHNlc3Npb24udXNlci5yb2xlID0gJ3VzZXInO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHNlc3Npb247XG4gICAgfSxcbiAgfSxcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46ICcvYXV0aC9zaWduaW4nLFxuICAgIGVycm9yOiAnL2F1dGgvZXJyb3InLFxuICB9LFxuICBzZXNzaW9uOiB7XG4gICAgc3RyYXRlZ3k6ICdqd3QnLFxuICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGRheXMgZm9yIHJlZ3VsYXIgdXNlcnNcbiAgfSxcbiAgY29va2llczoge1xuICAgIHNlc3Npb25Ub2tlbjoge1xuICAgICAgbmFtZTogYG5leHQtYXV0aC5zZXNzaW9uLXRva2VuYCxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgIHNhbWVTaXRlOiAnbGF4JyxcbiAgICAgICAgcGF0aDogJy8nLFxuICAgICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsIC8vIE9ubHkgc2VuZCBvdmVyIEhUVFBTIGluIHByb2R1Y3Rpb25cbiAgICAgIH0sXG4gICAgfSxcbiAgICBjYWxsYmFja1VybDoge1xuICAgICAgbmFtZTogYG5leHQtYXV0aC5jYWxsYmFjay11cmxgLFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBjc3JmVG9rZW46IHtcbiAgICAgIG5hbWU6IGBuZXh0LWF1dGguY3NyZi10b2tlbmAsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgICBzYW1lU2l0ZTogJ2xheCcsXG4gICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgICAgfSxcbiAgICB9LFxuICB9LFxuICBzZWNyZXQ6IHByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVCxcbiAgZGVidWc6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnLFxufTtcbiJdLCJuYW1lcyI6WyJDcmVkZW50aWFsc1Byb3ZpZGVyIiwiR29vZ2xlUHJvdmlkZXIiLCJGYWNlYm9va1Byb3ZpZGVyIiwiZGJDb25uZWN0IiwiVXNlciIsImJjcnlwdCIsImF1dGhPcHRpb25zIiwicHJvdmlkZXJzIiwibmFtZSIsImNyZWRlbnRpYWxzIiwiZW1haWwiLCJsYWJlbCIsInR5cGUiLCJwYXNzd29yZCIsImF1dGhvcml6ZSIsIkVycm9yIiwidXNlciIsImZpbmRPbmUiLCJwYXNzd29yZEhhc2giLCJpc1ZhbGlkUGFzc3dvcmQiLCJjb21wYXJlIiwiaXNBY3RpdmUiLCJpZCIsIl9pZCIsInRvU3RyaW5nIiwicm9sZSIsImltYWdlIiwiY2xpZW50SWQiLCJwcm9jZXNzIiwiZW52IiwiR09PR0xFX0NMSUVOVF9JRCIsImNsaWVudFNlY3JldCIsIkdPT0dMRV9DTElFTlRfU0VDUkVUIiwiRkFDRUJPT0tfQ0xJRU5UX0lEIiwiRkFDRUJPT0tfQ0xJRU5UX1NFQ1JFVCIsImNhbGxiYWNrcyIsInNpZ25JbiIsImFjY291bnQiLCJwcm9maWxlIiwicHJvdmlkZXIiLCJleGlzdGluZ1VzZXIiLCIkb3IiLCJnb29nbGVJZCIsInN1YiIsImZhY2Vib29rSWQiLCJzYXZlIiwibmV3VXNlciIsImVtYWlsVmVyaWZpZWQiLCJkYlVzZXIiLCJsYXN0TG9naW4iLCJEYXRlIiwiZSIsImp3dCIsInRva2VuIiwibWF4QWdlIiwibm93IiwiTWF0aCIsImZsb29yIiwiaXNzdWVkQXQiLCJpYXQiLCJzZXNzaW9uIiwiZmluZEJ5SWQiLCJwYWdlcyIsImVycm9yIiwic3RyYXRlZ3kiLCJjb29raWVzIiwic2Vzc2lvblRva2VuIiwib3B0aW9ucyIsImh0dHBPbmx5Iiwic2FtZVNpdGUiLCJwYXRoIiwic2VjdXJlIiwiY2FsbGJhY2tVcmwiLCJjc3JmVG9rZW4iLCJzZWNyZXQiLCJORVhUQVVUSF9TRUNSRVQiLCJkZWJ1ZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.js\n");

/***/ }),

/***/ "(rsc)/./lib/mongodb.js":
/*!************************!*\
  !*** ./lib/mongodb.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI;\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable inside .env.local\");\n}\n/**\r\n * Global is used here to maintain a cached connection across hot reloads\r\n * in development. This prevents connections growing exponentially\r\n * during API Route usage.\r\n */ let cached = global.mongoose;\nif (!cached) {\n    cached = global.mongoose = {\n        conn: null,\n        promise: null\n    };\n}\nasync function dbConnect() {\n    if (cached.conn) {\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false\n        };\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, opts).then((mongoose)=>{\n            return mongoose;\n        });\n    }\n    try {\n        cached.conn = await cached.promise;\n    } catch (e) {\n        cached.promise = null;\n        throw e;\n    }\n    return cached.conn;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (dbConnect);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbW9uZ29kYi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFFaEMsTUFBTUMsY0FBY0MsUUFBUUMsR0FBRyxDQUFDRixXQUFXO0FBRTNDLElBQUksQ0FBQ0EsYUFBYTtJQUNoQixNQUFNLElBQUlHLE1BQU07QUFDbEI7QUFFQTs7OztDQUlDLEdBQ0QsSUFBSUMsU0FBU0MsT0FBT04sUUFBUTtBQUU1QixJQUFJLENBQUNLLFFBQVE7SUFDWEEsU0FBU0MsT0FBT04sUUFBUSxHQUFHO1FBQUVPLE1BQU07UUFBTUMsU0FBUztJQUFLO0FBQ3pEO0FBRUEsZUFBZUM7SUFDYixJQUFJSixPQUFPRSxJQUFJLEVBQUU7UUFDZixPQUFPRixPQUFPRSxJQUFJO0lBQ3BCO0lBRUEsSUFBSSxDQUFDRixPQUFPRyxPQUFPLEVBQUU7UUFDbkIsTUFBTUUsT0FBTztZQUNYQyxnQkFBZ0I7UUFDbEI7UUFFQU4sT0FBT0csT0FBTyxHQUFHUix1REFBZ0IsQ0FBQ0MsYUFBYVMsTUFBTUcsSUFBSSxDQUFDLENBQUNiO1lBQ3pELE9BQU9BO1FBQ1Q7SUFDRjtJQUVBLElBQUk7UUFDRkssT0FBT0UsSUFBSSxHQUFHLE1BQU1GLE9BQU9HLE9BQU87SUFDcEMsRUFBRSxPQUFPTSxHQUFHO1FBQ1ZULE9BQU9HLE9BQU8sR0FBRztRQUNqQixNQUFNTTtJQUNSO0lBRUEsT0FBT1QsT0FBT0UsSUFBSTtBQUNwQjtBQUVBLGlFQUFlRSxTQUFTQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmlydmFhbmFhLWVjb21tZXJjZS8uL2xpYi9tb25nb2RiLmpzP2Q5MjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcclxuXHJcbmNvbnN0IE1PTkdPREJfVVJJID0gcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkk7XHJcblxyXG5pZiAoIU1PTkdPREJfVVJJKSB7XHJcbiAgdGhyb3cgbmV3IEVycm9yKCdQbGVhc2UgZGVmaW5lIHRoZSBNT05HT0RCX1VSSSBlbnZpcm9ubWVudCB2YXJpYWJsZSBpbnNpZGUgLmVudi5sb2NhbCcpO1xyXG59XHJcblxyXG4vKipcclxuICogR2xvYmFsIGlzIHVzZWQgaGVyZSB0byBtYWludGFpbiBhIGNhY2hlZCBjb25uZWN0aW9uIGFjcm9zcyBob3QgcmVsb2Fkc1xyXG4gKiBpbiBkZXZlbG9wbWVudC4gVGhpcyBwcmV2ZW50cyBjb25uZWN0aW9ucyBncm93aW5nIGV4cG9uZW50aWFsbHlcclxuICogZHVyaW5nIEFQSSBSb3V0ZSB1c2FnZS5cclxuICovXHJcbmxldCBjYWNoZWQgPSBnbG9iYWwubW9uZ29vc2U7XHJcblxyXG5pZiAoIWNhY2hlZCkge1xyXG4gIGNhY2hlZCA9IGdsb2JhbC5tb25nb29zZSA9IHsgY29ubjogbnVsbCwgcHJvbWlzZTogbnVsbCB9O1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBkYkNvbm5lY3QoKSB7XHJcbiAgaWYgKGNhY2hlZC5jb25uKSB7XHJcbiAgICByZXR1cm4gY2FjaGVkLmNvbm47XHJcbiAgfVxyXG5cclxuICBpZiAoIWNhY2hlZC5wcm9taXNlKSB7XHJcbiAgICBjb25zdCBvcHRzID0ge1xyXG4gICAgICBidWZmZXJDb21tYW5kczogZmFsc2UsXHJcbiAgICB9O1xyXG5cclxuICAgIGNhY2hlZC5wcm9taXNlID0gbW9uZ29vc2UuY29ubmVjdChNT05HT0RCX1VSSSwgb3B0cykudGhlbigobW9uZ29vc2UpID0+IHtcclxuICAgICAgcmV0dXJuIG1vbmdvb3NlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY2FjaGVkLmNvbm4gPSBhd2FpdCBjYWNoZWQucHJvbWlzZTtcclxuICB9IGNhdGNoIChlKSB7XHJcbiAgICBjYWNoZWQucHJvbWlzZSA9IG51bGw7XHJcbiAgICB0aHJvdyBlO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGNhY2hlZC5jb25uO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBkYkNvbm5lY3Q7XHJcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsIk1PTkdPREJfVVJJIiwicHJvY2VzcyIsImVudiIsIkVycm9yIiwiY2FjaGVkIiwiZ2xvYmFsIiwiY29ubiIsInByb21pc2UiLCJkYkNvbm5lY3QiLCJvcHRzIiwiYnVmZmVyQ29tbWFuZHMiLCJjb25uZWN0IiwidGhlbiIsImUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/mongodb.js\n");

/***/ }),

/***/ "(rsc)/./lib/rateLimit.js":
/*!**************************!*\
  !*** ./lib/rateLimit.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   rateLimit: () => (/* binding */ rateLimit),\n/* harmony export */   withRateLimit: () => (/* binding */ withRateLimit)\n/* harmony export */ });\n/* harmony import */ var rate_limiter_flexible__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rate-limiter-flexible */ \"(rsc)/./node_modules/rate-limiter-flexible/index.js\");\n/* harmony import */ var rate_limiter_flexible__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rate_limiter_flexible__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n\n\n// Create rate limiters for different endpoints\nconst rateLimiters = {\n    // Auth endpoints: 5 requests per 15 minutes per IP\n    auth: new rate_limiter_flexible__WEBPACK_IMPORTED_MODULE_0__.RateLimiterMemory({\n        points: 5,\n        duration: 15 * 60\n    }),\n    // API endpoints: 100 requests per 15 minutes per IP\n    api: new rate_limiter_flexible__WEBPACK_IMPORTED_MODULE_0__.RateLimiterMemory({\n        points: 100,\n        duration: 15 * 60\n    }),\n    // Payment endpoints: 10 requests per 15 minutes per IP\n    payment: new rate_limiter_flexible__WEBPACK_IMPORTED_MODULE_0__.RateLimiterMemory({\n        points: 10,\n        duration: 15 * 60\n    }),\n    // Admin endpoints: 30 requests per 15 minutes per IP\n    admin: new rate_limiter_flexible__WEBPACK_IMPORTED_MODULE_0__.RateLimiterMemory({\n        points: 30,\n        duration: 15 * 60\n    })\n};\n/**\r\n * Rate limiting middleware for Next.js API routes\r\n * @param {Request} request - The incoming request\r\n * @param {string} type - Type of rate limiter ('auth', 'api', 'payment', 'admin')\r\n * @returns {Promise<NextResponse|null>} - Returns error response if rate limited, null otherwise\r\n */ async function rateLimit(request, type = \"api\") {\n    try {\n        const limiter = rateLimiters[type] || rateLimiters.api;\n        // Get client IP address\n        const forwarded = request.headers.get(\"x-forwarded-for\");\n        const ip = forwarded ? forwarded.split(\",\")[0] : request.headers.get(\"x-real-ip\") || \"unknown\";\n        // Apply rate limit\n        await limiter.consume(ip);\n        return null; // No rate limit exceeded\n    } catch (error) {\n        // Rate limit exceeded\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__[\"default\"].json({\n            error: \"Too many requests. Please try again later.\",\n            retryAfter: Math.ceil(error.msBeforeNext / 1000) || 60\n        }, {\n            status: 429,\n            headers: {\n                \"Retry-After\": Math.ceil(error.msBeforeNext / 1000) || 60,\n                \"X-RateLimit-Limit\": error.totalHits || 100,\n                \"X-RateLimit-Remaining\": 0\n            }\n        });\n    }\n}\n/**\r\n * Wrapper function to apply rate limiting to API route handlers\r\n */ function withRateLimit(handler, type = \"api\") {\n    return async (request, context)=>{\n        const rateLimitResponse = await rateLimit(request, type);\n        if (rateLimitResponse) {\n            return rateLimitResponse;\n        }\n        return handler(request, context);\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcmF0ZUxpbWl0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTBEO0FBQ2Y7QUFFM0MsK0NBQStDO0FBQy9DLE1BQU1FLGVBQWU7SUFDbkIsbURBQW1EO0lBQ25EQyxNQUFNLElBQUlILG9FQUFpQkEsQ0FBQztRQUMxQkksUUFBUTtRQUNSQyxVQUFVLEtBQUs7SUFDakI7SUFDQSxvREFBb0Q7SUFDcERDLEtBQUssSUFBSU4sb0VBQWlCQSxDQUFDO1FBQ3pCSSxRQUFRO1FBQ1JDLFVBQVUsS0FBSztJQUNqQjtJQUNBLHVEQUF1RDtJQUN2REUsU0FBUyxJQUFJUCxvRUFBaUJBLENBQUM7UUFDN0JJLFFBQVE7UUFDUkMsVUFBVSxLQUFLO0lBQ2pCO0lBQ0EscURBQXFEO0lBQ3JERyxPQUFPLElBQUlSLG9FQUFpQkEsQ0FBQztRQUMzQkksUUFBUTtRQUNSQyxVQUFVLEtBQUs7SUFDakI7QUFDRjtBQUVBOzs7OztDQUtDLEdBQ00sZUFBZUksVUFBVUMsT0FBTyxFQUFFQyxPQUFPLEtBQUs7SUFDbkQsSUFBSTtRQUNGLE1BQU1DLFVBQVVWLFlBQVksQ0FBQ1MsS0FBSyxJQUFJVCxhQUFhSSxHQUFHO1FBRXRELHdCQUF3QjtRQUN4QixNQUFNTyxZQUFZSCxRQUFRSSxPQUFPLENBQUNDLEdBQUcsQ0FBQztRQUN0QyxNQUFNQyxLQUFLSCxZQUFZQSxVQUFVSSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FDbkNQLFFBQVFJLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGdCQUNwQjtRQUVYLG1CQUFtQjtRQUNuQixNQUFNSCxRQUFRTSxPQUFPLENBQUNGO1FBRXRCLE9BQU8sTUFBTSx5QkFBeUI7SUFDeEMsRUFBRSxPQUFPRyxPQUFPO1FBQ2Qsc0JBQXNCO1FBQ3RCLE9BQU9sQixrRkFBWUEsQ0FBQ21CLElBQUksQ0FDdEI7WUFDRUQsT0FBTztZQUNQRSxZQUFZQyxLQUFLQyxJQUFJLENBQUNKLE1BQU1LLFlBQVksR0FBRyxTQUFTO1FBQ3RELEdBQ0E7WUFDRUMsUUFBUTtZQUNSWCxTQUFTO2dCQUNQLGVBQWVRLEtBQUtDLElBQUksQ0FBQ0osTUFBTUssWUFBWSxHQUFHLFNBQVM7Z0JBQ3ZELHFCQUFxQkwsTUFBTU8sU0FBUyxJQUFJO2dCQUN4Qyx5QkFBeUI7WUFDM0I7UUFDRjtJQUVKO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNDLGNBQWNDLE9BQU8sRUFBRWpCLE9BQU8sS0FBSztJQUNqRCxPQUFPLE9BQU9ELFNBQVNtQjtRQUNyQixNQUFNQyxvQkFBb0IsTUFBTXJCLFVBQVVDLFNBQVNDO1FBQ25ELElBQUltQixtQkFBbUI7WUFDckIsT0FBT0E7UUFDVDtRQUNBLE9BQU9GLFFBQVFsQixTQUFTbUI7SUFDMUI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25pcnZhYW5hYS1lY29tbWVyY2UvLi9saWIvcmF0ZUxpbWl0LmpzPzZmM2MiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmF0ZUxpbWl0ZXJNZW1vcnkgfSBmcm9tICdyYXRlLWxpbWl0ZXItZmxleGlibGUnO1xyXG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcblxyXG4vLyBDcmVhdGUgcmF0ZSBsaW1pdGVycyBmb3IgZGlmZmVyZW50IGVuZHBvaW50c1xyXG5jb25zdCByYXRlTGltaXRlcnMgPSB7XHJcbiAgLy8gQXV0aCBlbmRwb2ludHM6IDUgcmVxdWVzdHMgcGVyIDE1IG1pbnV0ZXMgcGVyIElQXHJcbiAgYXV0aDogbmV3IFJhdGVMaW1pdGVyTWVtb3J5KHtcclxuICAgIHBvaW50czogNSxcclxuICAgIGR1cmF0aW9uOiAxNSAqIDYwLCAvLyAxNSBtaW51dGVzXHJcbiAgfSksXHJcbiAgLy8gQVBJIGVuZHBvaW50czogMTAwIHJlcXVlc3RzIHBlciAxNSBtaW51dGVzIHBlciBJUFxyXG4gIGFwaTogbmV3IFJhdGVMaW1pdGVyTWVtb3J5KHtcclxuICAgIHBvaW50czogMTAwLFxyXG4gICAgZHVyYXRpb246IDE1ICogNjAsIC8vIDE1IG1pbnV0ZXNcclxuICB9KSxcclxuICAvLyBQYXltZW50IGVuZHBvaW50czogMTAgcmVxdWVzdHMgcGVyIDE1IG1pbnV0ZXMgcGVyIElQXHJcbiAgcGF5bWVudDogbmV3IFJhdGVMaW1pdGVyTWVtb3J5KHtcclxuICAgIHBvaW50czogMTAsXHJcbiAgICBkdXJhdGlvbjogMTUgKiA2MCwgLy8gMTUgbWludXRlc1xyXG4gIH0pLFxyXG4gIC8vIEFkbWluIGVuZHBvaW50czogMzAgcmVxdWVzdHMgcGVyIDE1IG1pbnV0ZXMgcGVyIElQXHJcbiAgYWRtaW46IG5ldyBSYXRlTGltaXRlck1lbW9yeSh7XHJcbiAgICBwb2ludHM6IDMwLFxyXG4gICAgZHVyYXRpb246IDE1ICogNjAsIC8vIDE1IG1pbnV0ZXNcclxuICB9KSxcclxufTtcclxuXHJcbi8qKlxyXG4gKiBSYXRlIGxpbWl0aW5nIG1pZGRsZXdhcmUgZm9yIE5leHQuanMgQVBJIHJvdXRlc1xyXG4gKiBAcGFyYW0ge1JlcXVlc3R9IHJlcXVlc3QgLSBUaGUgaW5jb21pbmcgcmVxdWVzdFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFR5cGUgb2YgcmF0ZSBsaW1pdGVyICgnYXV0aCcsICdhcGknLCAncGF5bWVudCcsICdhZG1pbicpXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPE5leHRSZXNwb25zZXxudWxsPn0gLSBSZXR1cm5zIGVycm9yIHJlc3BvbnNlIGlmIHJhdGUgbGltaXRlZCwgbnVsbCBvdGhlcndpc2VcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByYXRlTGltaXQocmVxdWVzdCwgdHlwZSA9ICdhcGknKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGxpbWl0ZXIgPSByYXRlTGltaXRlcnNbdHlwZV0gfHwgcmF0ZUxpbWl0ZXJzLmFwaTtcclxuICAgIFxyXG4gICAgLy8gR2V0IGNsaWVudCBJUCBhZGRyZXNzXHJcbiAgICBjb25zdCBmb3J3YXJkZWQgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKTtcclxuICAgIGNvbnN0IGlwID0gZm9yd2FyZGVkID8gZm9yd2FyZGVkLnNwbGl0KCcsJylbMF0gOiBcclxuICAgICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmdldCgneC1yZWFsLWlwJykgfHwgXHJcbiAgICAgICAgICAgICAgICd1bmtub3duJztcclxuICAgIFxyXG4gICAgLy8gQXBwbHkgcmF0ZSBsaW1pdFxyXG4gICAgYXdhaXQgbGltaXRlci5jb25zdW1lKGlwKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIG51bGw7IC8vIE5vIHJhdGUgbGltaXQgZXhjZWVkZWRcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgLy8gUmF0ZSBsaW1pdCBleGNlZWRlZFxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IFxyXG4gICAgICAgIGVycm9yOiAnVG9vIG1hbnkgcmVxdWVzdHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyxcclxuICAgICAgICByZXRyeUFmdGVyOiBNYXRoLmNlaWwoZXJyb3IubXNCZWZvcmVOZXh0IC8gMTAwMCkgfHwgNjBcclxuICAgICAgfSxcclxuICAgICAgeyBcclxuICAgICAgICBzdGF0dXM6IDQyOSxcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnUmV0cnktQWZ0ZXInOiBNYXRoLmNlaWwoZXJyb3IubXNCZWZvcmVOZXh0IC8gMTAwMCkgfHwgNjAsXHJcbiAgICAgICAgICAnWC1SYXRlTGltaXQtTGltaXQnOiBlcnJvci50b3RhbEhpdHMgfHwgMTAwLFxyXG4gICAgICAgICAgJ1gtUmF0ZUxpbWl0LVJlbWFpbmluZyc6IDAsXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFdyYXBwZXIgZnVuY3Rpb24gdG8gYXBwbHkgcmF0ZSBsaW1pdGluZyB0byBBUEkgcm91dGUgaGFuZGxlcnNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRoUmF0ZUxpbWl0KGhhbmRsZXIsIHR5cGUgPSAnYXBpJykge1xyXG4gIHJldHVybiBhc3luYyAocmVxdWVzdCwgY29udGV4dCkgPT4ge1xyXG4gICAgY29uc3QgcmF0ZUxpbWl0UmVzcG9uc2UgPSBhd2FpdCByYXRlTGltaXQocmVxdWVzdCwgdHlwZSk7XHJcbiAgICBpZiAocmF0ZUxpbWl0UmVzcG9uc2UpIHtcclxuICAgICAgcmV0dXJuIHJhdGVMaW1pdFJlc3BvbnNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhbmRsZXIocmVxdWVzdCwgY29udGV4dCk7XHJcbiAgfTtcclxufVxyXG5cclxuIl0sIm5hbWVzIjpbIlJhdGVMaW1pdGVyTWVtb3J5IiwiTmV4dFJlc3BvbnNlIiwicmF0ZUxpbWl0ZXJzIiwiYXV0aCIsInBvaW50cyIsImR1cmF0aW9uIiwiYXBpIiwicGF5bWVudCIsImFkbWluIiwicmF0ZUxpbWl0IiwicmVxdWVzdCIsInR5cGUiLCJsaW1pdGVyIiwiZm9yd2FyZGVkIiwiaGVhZGVycyIsImdldCIsImlwIiwic3BsaXQiLCJjb25zdW1lIiwiZXJyb3IiLCJqc29uIiwicmV0cnlBZnRlciIsIk1hdGgiLCJjZWlsIiwibXNCZWZvcmVOZXh0Iiwic3RhdHVzIiwidG90YWxIaXRzIiwid2l0aFJhdGVMaW1pdCIsImhhbmRsZXIiLCJjb250ZXh0IiwicmF0ZUxpbWl0UmVzcG9uc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/rateLimit.js\n");

/***/ }),

/***/ "(rsc)/./models/Order.js":
/*!*************************!*\
  !*** ./models/Order.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst orderSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    orderNumber: {\n        type: String,\n        // required: true,\n        unique: true\n    },\n    userId: {\n        type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema).Types.ObjectId,\n        ref: \"User\",\n        required: true\n    },\n    items: [\n        {\n            productId: {\n                type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema).Types.ObjectId,\n                ref: \"Product\",\n                required: true\n            },\n            name: {\n                type: String,\n                required: true\n            },\n            image: {\n                type: String,\n                required: true\n            },\n            price: {\n                type: Number,\n                required: true,\n                min: 0\n            },\n            originalPrice: {\n                type: Number,\n                min: 0,\n                default: 0\n            },\n            discount: {\n                type: Number,\n                min: 0,\n                default: 0\n            },\n            quantity: {\n                type: Number,\n                required: true,\n                min: 1\n            },\n            sku: String,\n            colorVariant: {\n                name: String,\n                hex: String,\n                images: [\n                    String\n                ]\n            }\n        }\n    ],\n    subtotal: {\n        type: Number,\n        required: true,\n        min: 0\n    },\n    tax: {\n        type: Number,\n        required: true,\n        min: 0,\n        default: 0\n    },\n    shipping: {\n        type: Number,\n        required: true,\n        min: 0,\n        default: 0\n    },\n    discount: {\n        type: Number,\n        required: true,\n        min: 0,\n        default: 0\n    },\n    total: {\n        type: Number,\n        required: true,\n        min: 0\n    },\n    currency: {\n        type: String,\n        required: true,\n        default: \"INR\"\n    },\n    status: {\n        type: String,\n        enum: [\n            \"pending\",\n            \"processing\",\n            \"shipped\",\n            \"delivered\",\n            \"cancelled\",\n            \"refunded\"\n        ],\n        default: \"pending\"\n    },\n    paymentStatus: {\n        type: String,\n        enum: [\n            \"pending\",\n            \"paid\",\n            \"failed\",\n            \"refunded\"\n        ],\n        default: \"pending\"\n    },\n    paymentMethod: {\n        type: String,\n        enum: [\n            \"razorpay\",\n            \"cod\"\n        ],\n        required: true\n    },\n    razorpayOrderId: {\n        type: String,\n        sparse: true\n    },\n    razorpayPaymentId: {\n        type: String,\n        sparse: true\n    },\n    shippingAddress: {\n        name: {\n            type: String,\n            required: true\n        },\n        phone: {\n            type: String,\n            required: true\n        },\n        street: {\n            type: String,\n            required: true\n        },\n        city: {\n            type: String,\n            required: true\n        },\n        state: {\n            type: String,\n            required: true\n        },\n        zipCode: {\n            type: String,\n            required: true\n        },\n        country: {\n            type: String,\n            required: true,\n            default: \"India\"\n        }\n    },\n    billingAddress: {\n        name: {\n            type: String,\n            required: true\n        },\n        phone: {\n            type: String,\n            required: true\n        },\n        street: {\n            type: String,\n            required: true\n        },\n        city: {\n            type: String,\n            required: true\n        },\n        state: {\n            type: String,\n            required: true\n        },\n        zipCode: {\n            type: String,\n            required: true\n        },\n        country: {\n            type: String,\n            required: true,\n            default: \"India\"\n        }\n    },\n    shippingMethod: {\n        name: {\n            type: String,\n            required: true,\n            default: \"Standard Shipping\"\n        },\n        estimatedDays: {\n            type: Number,\n            required: true,\n            default: 5\n        },\n        trackingNumber: String,\n        trackingUrl: String\n    },\n    notes: {\n        customer: String,\n        admin: String\n    },\n    timeline: [\n        {\n            status: {\n                type: String,\n                required: true\n            },\n            message: {\n                type: String,\n                required: true\n            },\n            timestamp: {\n                type: Date,\n                default: Date.now\n            },\n            updatedBy: {\n                type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema).Types.ObjectId,\n                ref: \"User\"\n            }\n        }\n    ],\n    emailSent: {\n        confirmation: {\n            type: Boolean,\n            default: false\n        },\n        shipped: {\n            type: Boolean,\n            default: false\n        },\n        delivered: {\n            type: Boolean,\n            default: false\n        }\n    },\n    smsSent: {\n        confirmation: {\n            type: Boolean,\n            default: false\n        },\n        shipped: {\n            type: Boolean,\n            default: false\n        },\n        delivered: {\n            type: Boolean,\n            default: false\n        }\n    },\n    refundAmount: {\n        type: Number,\n        min: 0\n    },\n    refundReason: String,\n    cancelledAt: Date,\n    cancelledBy: {\n        type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema).Types.ObjectId,\n        ref: \"User\"\n    },\n    deliveredAt: Date\n}, {\n    timestamps: true\n});\n// Indexes for efficient queries\norderSchema.index({\n    orderNumber: 1\n});\norderSchema.index({\n    userId: 1\n});\norderSchema.index({\n    status: 1\n});\norderSchema.index({\n    paymentStatus: 1\n});\norderSchema.index({\n    createdAt: -1\n});\norderSchema.index({\n    razorpayOrderId: 1\n});\norderSchema.index({\n    razorpayPaymentId: 1\n});\norderSchema.index({\n    \"shippingAddress.phone\": 1\n});\n// Virtual for order summary\norderSchema.virtual(\"orderSummary\").get(function() {\n    return {\n        orderNumber: this.orderNumber,\n        total: this.total,\n        status: this.status,\n        itemCount: this.items.length,\n        createdAt: this.createdAt\n    };\n});\n// Virtual for customer info\norderSchema.virtual(\"customerInfo\").get(function() {\n    return {\n        name: this.shippingAddress.name,\n        phone: this.shippingAddress.phone,\n        email: this.userId?.email\n    };\n});\n// Instance method to add timeline entry\norderSchema.methods.addTimelineEntry = function(status, message, updatedBy = null) {\n    this.timeline.push({\n        status,\n        message,\n        timestamp: new Date(),\n        updatedBy\n    });\n    return this.save();\n};\n// Instance method to update status\norderSchema.methods.updateStatus = function(newStatus, message, updatedBy = null) {\n    this.status = newStatus;\n    this.addTimelineEntry(newStatus, message, updatedBy);\n    // Set deliveredAt if status is delivered\n    if (newStatus === \"delivered\") {\n        this.deliveredAt = new Date();\n    }\n    // Set cancelledAt if status is cancelled\n    if (newStatus === \"cancelled\") {\n        this.cancelledAt = new Date();\n        this.cancelledBy = updatedBy;\n    }\n    return this.save();\n};\n// Instance method to calculate totals\norderSchema.methods.calculateTotals = function() {\n    this.subtotal = this.items.reduce((sum, item)=>sum + item.price * item.quantity, 0);\n    this.total = this.subtotal + this.tax + this.shipping - this.discount;\n    return this.save();\n};\n// Static method to generate order number\norderSchema.statics.generateOrderNumber = async function() {\n    const date = new Date();\n    const year = date.getFullYear().toString().slice(-2);\n    const month = (date.getMonth() + 1).toString().padStart(2, \"0\");\n    const day = date.getDate().toString().padStart(2, \"0\");\n    // Get count of orders today\n    const todayStart = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n    const todayEnd = new Date(date.getFullYear(), date.getMonth(), date.getDate() + 1);\n    const todayOrders = await this.countDocuments({\n        createdAt: {\n            $gte: todayStart,\n            $lt: todayEnd\n        }\n    });\n    const sequence = (todayOrders + 1).toString().padStart(3, \"0\");\n    return `NV${year}${month}${day}${sequence}`;\n};\n// Static method to find by user\norderSchema.statics.findByUser = function(userId) {\n    return this.find({\n        userId\n    }).sort({\n        createdAt: -1\n    });\n};\n// Static method to find pending orders\norderSchema.statics.findPending = function() {\n    return this.find({\n        status: \"pending\"\n    }).sort({\n        createdAt: -1\n    });\n};\n// Static method to find by status\norderSchema.statics.findByStatus = function(status) {\n    return this.find({\n        status\n    }).sort({\n        createdAt: -1\n    });\n};\n// Pre-save middleware to generate order number\norderSchema.pre(\"save\", async function(next) {\n    if (this.isNew && !this.orderNumber) {\n        this.orderNumber = await this.constructor.generateOrderNumber();\n    }\n    next();\n});\n// Ensure virtuals are serialized\norderSchema.set(\"toJSON\", {\n    virtuals: true,\n    transform: function(doc, ret) {\n        delete ret.__v;\n        return ret;\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).Order || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"Order\", orderSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RTtBQUNwRDtBQUVBLHVDQUF1QztBQUN2Q3hFLFlBQVl3RixPQUFPLENBQUNzQixXQUFXLEdBQUc7SUFDaEMsT0FBTyxJQUFJLENBQUNGLElBQUksQ0FBQztRQUFFN0UsUUFBUTtJQUFVLEdBQUc4RSxJQUFJLENBQUM7UUFBRXJDLFdBQVcsQ0FBQztJQUFFO0FBQy9EO0FBRUEsa0NBQWtDO0FBQ2xDeEUsWUFBWXdGLE9BQU8sQ0FBQ3VCLFlBQVksR0FBRyxTQUFTaEYsTUFBTTtJQUNoRCxPQUFPLElBQUksQ0FBQzZFLElBQUksQ0FBQztRQUFFN0U7SUFBTyxHQUFHOEUsSUFBSSxDQUFDO1FBQUVyQyxXQUFXLENBQUM7SUFBRTtBQUNwRDtBQUVBLCtDQUErQztBQUMvQ3hFLFlBQVlnSCxHQUFHLENBQUMsUUFBUSxlQUFlQyxJQUFJO0lBQ3pDLElBQUksSUFBSSxDQUFDQyxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUNoSCxXQUFXLEVBQUU7UUFDbkMsSUFBSSxDQUFDQSxXQUFXLEdBQUcsTUFBTSxJQUFJLENBQUNpSCxXQUFXLENBQUMxQixtQkFBbUI7SUFDL0Q7SUFDQXdCO0FBQ0Y7QUFFQSxpQ0FBaUM7QUFDakNqSCxZQUFZb0gsR0FBRyxDQUFDLFVBQVU7SUFDeEJDLFVBQVU7SUFDVkMsV0FBVyxTQUFTQyxHQUFHLEVBQUVDLEdBQUc7UUFDMUIsT0FBT0EsSUFBSUMsR0FBRztRQUNkLE9BQU9EO0lBQ1Q7QUFDRjtBQUVBLGlFQUFlekgsd0RBQWUsQ0FBQzRILEtBQUssSUFBSTVILHFEQUFjLENBQUMsU0FBU0MsWUFBWUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25pcnZhYW5hYS1lY29tbWVyY2UvLi9tb2RlbHMvT3JkZXIuanM/ZWIyOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xyXG5cclxuY29uc3Qgb3JkZXJTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICBvcmRlck51bWJlcjoge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAvLyByZXF1aXJlZDogdHJ1ZSxcclxuICAgIHVuaXF1ZTogdHJ1ZSxcclxuICB9LFxyXG4gIHVzZXJJZDoge1xyXG4gICAgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLFxyXG4gICAgcmVmOiAnVXNlcicsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICB9LFxyXG4gIGl0ZW1zOiBbe1xyXG4gICAgcHJvZHVjdElkOiB7XHJcbiAgICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcclxuICAgICAgcmVmOiAnUHJvZHVjdCcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIG5hbWU6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBpbWFnZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIHByaWNlOiB7XHJcbiAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIG1pbjogMCxcclxuICAgIH0sXHJcbiAgICBvcmlnaW5hbFByaWNlOiB7XHJcbiAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgbWluOiAwLFxyXG4gICAgICBkZWZhdWx0OiAwLFxyXG4gICAgfSxcclxuICAgIGRpc2NvdW50OiB7XHJcbiAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgbWluOiAwLFxyXG4gICAgICBkZWZhdWx0OiAwLFxyXG4gICAgfSxcclxuICAgIHF1YW50aXR5OiB7XHJcbiAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIG1pbjogMSxcclxuICAgIH0sXHJcbiAgICBza3U6IFN0cmluZyxcclxuICAgIGNvbG9yVmFyaWFudDoge1xyXG4gICAgICBuYW1lOiBTdHJpbmcsXHJcbiAgICAgIGhleDogU3RyaW5nLFxyXG4gICAgICBpbWFnZXM6IFtTdHJpbmddLFxyXG4gICAgfSxcclxuICB9XSxcclxuICBzdWJ0b3RhbDoge1xyXG4gICAgdHlwZTogTnVtYmVyLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICBtaW46IDAsXHJcbiAgfSxcclxuICB0YXg6IHtcclxuICAgIHR5cGU6IE51bWJlcixcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgbWluOiAwLFxyXG4gICAgZGVmYXVsdDogMCxcclxuICB9LFxyXG4gIHNoaXBwaW5nOiB7XHJcbiAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIG1pbjogMCxcclxuICAgIGRlZmF1bHQ6IDAsXHJcbiAgfSxcclxuICBkaXNjb3VudDoge1xyXG4gICAgdHlwZTogTnVtYmVyLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICBtaW46IDAsXHJcbiAgICBkZWZhdWx0OiAwLFxyXG4gIH0sXHJcbiAgdG90YWw6IHtcclxuICAgIHR5cGU6IE51bWJlcixcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgbWluOiAwLFxyXG4gIH0sXHJcbiAgY3VycmVuY3k6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgZGVmYXVsdDogJ0lOUicsXHJcbiAgfSxcclxuICBzdGF0dXM6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIGVudW06IFsncGVuZGluZycsICdwcm9jZXNzaW5nJywgJ3NoaXBwZWQnLCAnZGVsaXZlcmVkJywgJ2NhbmNlbGxlZCcsICdyZWZ1bmRlZCddLFxyXG4gICAgZGVmYXVsdDogJ3BlbmRpbmcnLFxyXG4gIH0sXHJcbiAgcGF5bWVudFN0YXR1czoge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgZW51bTogWydwZW5kaW5nJywgJ3BhaWQnLCAnZmFpbGVkJywgJ3JlZnVuZGVkJ10sXHJcbiAgICBkZWZhdWx0OiAncGVuZGluZycsXHJcbiAgfSxcclxuICBwYXltZW50TWV0aG9kOiB7XHJcbiAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICBlbnVtOiBbJ3Jhem9ycGF5JywgJ2NvZCddLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgfSxcclxuICByYXpvcnBheU9yZGVySWQ6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIHNwYXJzZTogdHJ1ZSxcclxuICB9LFxyXG4gIHJhem9ycGF5UGF5bWVudElkOiB7XHJcbiAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICBzcGFyc2U6IHRydWUsXHJcbiAgfSxcclxuICBzaGlwcGluZ0FkZHJlc3M6IHtcclxuICAgIG5hbWU6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBwaG9uZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIHN0cmVldDoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIGNpdHk6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBzdGF0ZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIHppcENvZGU6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBjb3VudHJ5OiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIGRlZmF1bHQ6ICdJbmRpYScsXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgYmlsbGluZ0FkZHJlc3M6IHtcclxuICAgIG5hbWU6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBwaG9uZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIHN0cmVldDoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIGNpdHk6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBzdGF0ZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIHppcENvZGU6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBjb3VudHJ5OiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIGRlZmF1bHQ6ICdJbmRpYScsXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgc2hpcHBpbmdNZXRob2Q6IHtcclxuICAgIG5hbWU6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgZGVmYXVsdDogJ1N0YW5kYXJkIFNoaXBwaW5nJyxcclxuICAgIH0sXHJcbiAgICBlc3RpbWF0ZWREYXlzOiB7XHJcbiAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIGRlZmF1bHQ6IDUsXHJcbiAgICB9LFxyXG4gICAgdHJhY2tpbmdOdW1iZXI6IFN0cmluZyxcclxuICAgIHRyYWNraW5nVXJsOiBTdHJpbmcsXHJcbiAgfSxcclxuICBub3Rlczoge1xyXG4gICAgY3VzdG9tZXI6IFN0cmluZyxcclxuICAgIGFkbWluOiBTdHJpbmcsXHJcbiAgfSxcclxuICB0aW1lbGluZTogW3tcclxuICAgIHN0YXR1czoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIG1lc3NhZ2U6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICB0aW1lc3RhbXA6IHtcclxuICAgICAgdHlwZTogRGF0ZSxcclxuICAgICAgZGVmYXVsdDogRGF0ZS5ub3csXHJcbiAgICB9LFxyXG4gICAgdXBkYXRlZEJ5OiB7XHJcbiAgICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcclxuICAgICAgcmVmOiAnVXNlcicsXHJcbiAgICB9LFxyXG4gIH1dLFxyXG4gIGVtYWlsU2VudDoge1xyXG4gICAgY29uZmlybWF0aW9uOiB7XHJcbiAgICAgIHR5cGU6IEJvb2xlYW4sXHJcbiAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIHNoaXBwZWQ6IHtcclxuICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgZGVmYXVsdDogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAgZGVsaXZlcmVkOiB7XHJcbiAgICAgIHR5cGU6IEJvb2xlYW4sXHJcbiAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgfSxcclxuICB9LFxyXG4gIHNtc1NlbnQ6IHtcclxuICAgIGNvbmZpcm1hdGlvbjoge1xyXG4gICAgICB0eXBlOiBCb29sZWFuLFxyXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICBzaGlwcGVkOiB7XHJcbiAgICAgIHR5cGU6IEJvb2xlYW4sXHJcbiAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIGRlbGl2ZXJlZDoge1xyXG4gICAgICB0eXBlOiBCb29sZWFuLFxyXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcclxuICAgIH0sXHJcbiAgfSxcclxuICByZWZ1bmRBbW91bnQ6IHtcclxuICAgIHR5cGU6IE51bWJlcixcclxuICAgIG1pbjogMCxcclxuICB9LFxyXG4gIHJlZnVuZFJlYXNvbjogU3RyaW5nLFxyXG4gIGNhbmNlbGxlZEF0OiBEYXRlLFxyXG4gIGNhbmNlbGxlZEJ5OiB7XHJcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICByZWY6ICdVc2VyJyxcclxuICB9LFxyXG4gIGRlbGl2ZXJlZEF0OiBEYXRlLFxyXG59LCB7XHJcbiAgdGltZXN0YW1wczogdHJ1ZSxcclxufSk7XHJcblxyXG4vLyBJbmRleGVzIGZvciBlZmZpY2llbnQgcXVlcmllc1xyXG5vcmRlclNjaGVtYS5pbmRleCh7IG9yZGVyTnVtYmVyOiAxIH0pO1xyXG5vcmRlclNjaGVtYS5pbmRleCh7IHVzZXJJZDogMSB9KTtcclxub3JkZXJTY2hlbWEuaW5kZXgoeyBzdGF0dXM6IDEgfSk7XHJcbm9yZGVyU2NoZW1hLmluZGV4KHsgcGF5bWVudFN0YXR1czogMSB9KTtcclxub3JkZXJTY2hlbWEuaW5kZXgoeyBjcmVhdGVkQXQ6IC0xIH0pO1xyXG5vcmRlclNjaGVtYS5pbmRleCh7IHJhem9ycGF5T3JkZXJJZDogMSB9KTtcclxub3JkZXJTY2hlbWEuaW5kZXgoeyByYXpvcnBheVBheW1lbnRJZDogMSB9KTtcclxub3JkZXJTY2hlbWEuaW5kZXgoeyAnc2hpcHBpbmdBZGRyZXNzLnBob25lJzogMSB9KTtcclxuXHJcbi8vIFZpcnR1YWwgZm9yIG9yZGVyIHN1bW1hcnlcclxub3JkZXJTY2hlbWEudmlydHVhbCgnb3JkZXJTdW1tYXJ5JykuZ2V0KGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICBvcmRlck51bWJlcjogdGhpcy5vcmRlck51bWJlcixcclxuICAgIHRvdGFsOiB0aGlzLnRvdGFsLFxyXG4gICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcclxuICAgIGl0ZW1Db3VudDogdGhpcy5pdGVtcy5sZW5ndGgsXHJcbiAgICBjcmVhdGVkQXQ6IHRoaXMuY3JlYXRlZEF0LFxyXG4gIH07XHJcbn0pO1xyXG5cclxuLy8gVmlydHVhbCBmb3IgY3VzdG9tZXIgaW5mb1xyXG5vcmRlclNjaGVtYS52aXJ0dWFsKCdjdXN0b21lckluZm8nKS5nZXQoZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIG5hbWU6IHRoaXMuc2hpcHBpbmdBZGRyZXNzLm5hbWUsXHJcbiAgICBwaG9uZTogdGhpcy5zaGlwcGluZ0FkZHJlc3MucGhvbmUsXHJcbiAgICBlbWFpbDogdGhpcy51c2VySWQ/LmVtYWlsLFxyXG4gIH07XHJcbn0pO1xyXG5cclxuLy8gSW5zdGFuY2UgbWV0aG9kIHRvIGFkZCB0aW1lbGluZSBlbnRyeVxyXG5vcmRlclNjaGVtYS5tZXRob2RzLmFkZFRpbWVsaW5lRW50cnkgPSBmdW5jdGlvbihzdGF0dXMsIG1lc3NhZ2UsIHVwZGF0ZWRCeSA9IG51bGwpIHtcclxuICB0aGlzLnRpbWVsaW5lLnB1c2goe1xyXG4gICAgc3RhdHVzLFxyXG4gICAgbWVzc2FnZSxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgIHVwZGF0ZWRCeSxcclxuICB9KTtcclxuICByZXR1cm4gdGhpcy5zYXZlKCk7XHJcbn07XHJcblxyXG4vLyBJbnN0YW5jZSBtZXRob2QgdG8gdXBkYXRlIHN0YXR1c1xyXG5vcmRlclNjaGVtYS5tZXRob2RzLnVwZGF0ZVN0YXR1cyA9IGZ1bmN0aW9uKG5ld1N0YXR1cywgbWVzc2FnZSwgdXBkYXRlZEJ5ID0gbnVsbCkge1xyXG4gIHRoaXMuc3RhdHVzID0gbmV3U3RhdHVzO1xyXG4gIHRoaXMuYWRkVGltZWxpbmVFbnRyeShuZXdTdGF0dXMsIG1lc3NhZ2UsIHVwZGF0ZWRCeSk7XHJcbiAgXHJcbiAgLy8gU2V0IGRlbGl2ZXJlZEF0IGlmIHN0YXR1cyBpcyBkZWxpdmVyZWRcclxuICBpZiAobmV3U3RhdHVzID09PSAnZGVsaXZlcmVkJykge1xyXG4gICAgdGhpcy5kZWxpdmVyZWRBdCA9IG5ldyBEYXRlKCk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFNldCBjYW5jZWxsZWRBdCBpZiBzdGF0dXMgaXMgY2FuY2VsbGVkXHJcbiAgaWYgKG5ld1N0YXR1cyA9PT0gJ2NhbmNlbGxlZCcpIHtcclxuICAgIHRoaXMuY2FuY2VsbGVkQXQgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdGhpcy5jYW5jZWxsZWRCeSA9IHVwZGF0ZWRCeTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xyXG59O1xyXG5cclxuLy8gSW5zdGFuY2UgbWV0aG9kIHRvIGNhbGN1bGF0ZSB0b3RhbHNcclxub3JkZXJTY2hlbWEubWV0aG9kcy5jYWxjdWxhdGVUb3RhbHMgPSBmdW5jdGlvbigpIHtcclxuICB0aGlzLnN1YnRvdGFsID0gdGhpcy5pdGVtcy5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKGl0ZW0ucHJpY2UgKiBpdGVtLnF1YW50aXR5KSwgMCk7XHJcbiAgdGhpcy50b3RhbCA9IHRoaXMuc3VidG90YWwgKyB0aGlzLnRheCArIHRoaXMuc2hpcHBpbmcgLSB0aGlzLmRpc2NvdW50O1xyXG4gIHJldHVybiB0aGlzLnNhdmUoKTtcclxufTtcclxuXHJcbi8vIFN0YXRpYyBtZXRob2QgdG8gZ2VuZXJhdGUgb3JkZXIgbnVtYmVyXHJcbm9yZGVyU2NoZW1hLnN0YXRpY3MuZ2VuZXJhdGVPcmRlck51bWJlciA9IGFzeW5jIGZ1bmN0aW9uKCkge1xyXG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gIGNvbnN0IHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKS5zbGljZSgtMik7XHJcbiAgY29uc3QgbW9udGggPSAoZGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpO1xyXG4gIGNvbnN0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTtcclxuICBcclxuICAvLyBHZXQgY291bnQgb2Ygb3JkZXJzIHRvZGF5XHJcbiAgY29uc3QgdG9kYXlTdGFydCA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpLCBkYXRlLmdldERhdGUoKSk7XHJcbiAgY29uc3QgdG9kYXlFbmQgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSwgZGF0ZS5nZXREYXRlKCkgKyAxKTtcclxuICBcclxuICBjb25zdCB0b2RheU9yZGVycyA9IGF3YWl0IHRoaXMuY291bnREb2N1bWVudHMoe1xyXG4gICAgY3JlYXRlZEF0OiB7ICRndGU6IHRvZGF5U3RhcnQsICRsdDogdG9kYXlFbmQgfVxyXG4gIH0pO1xyXG4gIFxyXG4gIGNvbnN0IHNlcXVlbmNlID0gKHRvZGF5T3JkZXJzICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgzLCAnMCcpO1xyXG4gIHJldHVybiBgTlYke3llYXJ9JHttb250aH0ke2RheX0ke3NlcXVlbmNlfWA7XHJcbn07XHJcblxyXG4vLyBTdGF0aWMgbWV0aG9kIHRvIGZpbmQgYnkgdXNlclxyXG5vcmRlclNjaGVtYS5zdGF0aWNzLmZpbmRCeVVzZXIgPSBmdW5jdGlvbih1c2VySWQpIHtcclxuICByZXR1cm4gdGhpcy5maW5kKHsgdXNlcklkIH0pLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xyXG59O1xyXG5cclxuLy8gU3RhdGljIG1ldGhvZCB0byBmaW5kIHBlbmRpbmcgb3JkZXJzXHJcbm9yZGVyU2NoZW1hLnN0YXRpY3MuZmluZFBlbmRpbmcgPSBmdW5jdGlvbigpIHtcclxuICByZXR1cm4gdGhpcy5maW5kKHsgc3RhdHVzOiAncGVuZGluZycgfSkuc29ydCh7IGNyZWF0ZWRBdDogLTEgfSk7XHJcbn07XHJcblxyXG4vLyBTdGF0aWMgbWV0aG9kIHRvIGZpbmQgYnkgc3RhdHVzXHJcbm9yZGVyU2NoZW1hLnN0YXRpY3MuZmluZEJ5U3RhdHVzID0gZnVuY3Rpb24oc3RhdHVzKSB7XHJcbiAgcmV0dXJuIHRoaXMuZmluZCh7IHN0YXR1cyB9KS5zb3J0KHsgY3JlYXRlZEF0OiAtMSB9KTtcclxufTtcclxuXHJcbi8vIFByZS1zYXZlIG1pZGRsZXdhcmUgdG8gZ2VuZXJhdGUgb3JkZXIgbnVtYmVyXHJcbm9yZGVyU2NoZW1hLnByZSgnc2F2ZScsIGFzeW5jIGZ1bmN0aW9uKG5leHQpIHtcclxuICBpZiAodGhpcy5pc05ldyAmJiAhdGhpcy5vcmRlck51bWJlcikge1xyXG4gICAgdGhpcy5vcmRlck51bWJlciA9IGF3YWl0IHRoaXMuY29uc3RydWN0b3IuZ2VuZXJhdGVPcmRlck51bWJlcigpO1xyXG4gIH1cclxuICBuZXh0KCk7XHJcbn0pO1xyXG5cclxuLy8gRW5zdXJlIHZpcnR1YWxzIGFyZSBzZXJpYWxpemVkXHJcbm9yZGVyU2NoZW1hLnNldCgndG9KU09OJywge1xyXG4gIHZpcnR1YWxzOiB0cnVlLFxyXG4gIHRyYW5zZm9ybTogZnVuY3Rpb24oZG9jLCByZXQpIHtcclxuICAgIGRlbGV0ZSByZXQuX192O1xyXG4gICAgcmV0dXJuIHJldDtcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IG1vbmdvb3NlLm1vZGVscy5PcmRlciB8fCBtb25nb29zZS5tb2RlbCgnT3JkZXInLCBvcmRlclNjaGVtYSk7XHJcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsIm9yZGVyU2NoZW1hIiwiU2NoZW1hIiwib3JkZXJOdW1iZXIiLCJ0eXBlIiwiU3RyaW5nIiwidW5pcXVlIiwidXNlcklkIiwiVHlwZXMiLCJPYmplY3RJZCIsInJlZiIsInJlcXVpcmVkIiwiaXRlbXMiLCJwcm9kdWN0SWQiLCJuYW1lIiwiaW1hZ2UiLCJwcmljZSIsIk51bWJlciIsIm1pbiIsIm9yaWdpbmFsUHJpY2UiLCJkZWZhdWx0IiwiZGlzY291bnQiLCJxdWFudGl0eSIsInNrdSIsImNvbG9yVmFyaWFudCIsImhleCIsImltYWdlcyIsInN1YnRvdGFsIiwidGF4Iiwic2hpcHBpbmciLCJ0b3RhbCIsImN1cnJlbmN5Iiwic3RhdHVzIiwiZW51bSIsInBheW1lbnRTdGF0dXMiLCJwYXltZW50TWV0aG9kIiwicmF6b3JwYXlPcmRlcklkIiwic3BhcnNlIiwicmF6b3JwYXlQYXltZW50SWQiLCJzaGlwcGluZ0FkZHJlc3MiLCJwaG9uZSIsInN0cmVldCIsImNpdHkiLCJzdGF0ZSIsInppcENvZGUiLCJjb3VudHJ5IiwiYmlsbGluZ0FkZHJlc3MiLCJzaGlwcGluZ01ldGhvZCIsImVzdGltYXRlZERheXMiLCJ0cmFja2luZ051bWJlciIsInRyYWNraW5nVXJsIiwibm90ZXMiLCJjdXN0b21lciIsImFkbWluIiwidGltZWxpbmUiLCJtZXNzYWdlIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInVwZGF0ZWRCeSIsImVtYWlsU2VudCIsImNvbmZpcm1hdGlvbiIsIkJvb2xlYW4iLCJzaGlwcGVkIiwiZGVsaXZlcmVkIiwic21zU2VudCIsInJlZnVuZEFtb3VudCIsInJlZnVuZFJlYXNvbiIsImNhbmNlbGxlZEF0IiwiY2FuY2VsbGVkQnkiLCJkZWxpdmVyZWRBdCIsInRpbWVzdGFtcHMiLCJpbmRleCIsImNyZWF0ZWRBdCIsInZpcnR1YWwiLCJnZXQiLCJpdGVtQ291bnQiLCJsZW5ndGgiLCJlbWFpbCIsIm1ldGhvZHMiLCJhZGRUaW1lbGluZUVudHJ5IiwicHVzaCIsInNhdmUiLCJ1cGRhdGVTdGF0dXMiLCJuZXdTdGF0dXMiLCJjYWxjdWxhdGVUb3RhbHMiLCJyZWR1Y2UiLCJzdW0iLCJpdGVtIiwic3RhdGljcyIsImdlbmVyYXRlT3JkZXJOdW1iZXIiLCJkYXRlIiwieWVhciIsImdldEZ1bGxZZWFyIiwidG9TdHJpbmciLCJzbGljZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJwYWRTdGFydCIsImRheSIsImdldERhdGUiLCJ0b2RheVN0YXJ0IiwidG9kYXlFbmQiLCJ0b2RheU9yZGVycyIsImNvdW50RG9jdW1lbnRzIiwiJGd0ZSIsIiRsdCIsInNlcXVlbmNlIiwiZmluZEJ5VXNlciIsImZpbmQiLCJzb3J0IiwiZmluZFBlbmRpbmciLCJmaW5kQnlTdGF0dXMiLCJwcmUiLCJuZXh0IiwiaXNOZXciLCJjb25zdHJ1Y3RvciIsInNldCIsInZpcnR1YWxzIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwibW9kZWxzIiwiT3JkZXIiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./models/Order.js\n");

/***/ }),

/***/ "(rsc)/./models/Product.js":
/*!***************************!*\
  !*** ./models/Product.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst productSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    title: {\n        type: String,\n        required: [\n            true,\n            \"Product title is required\"\n        ],\n        trim: true,\n        maxlength: [\n            100,\n            \"Title cannot be more than 100 characters\"\n        ]\n    },\n    slug: {\n        type: String,\n        required: [\n            true,\n            \"Product slug is required\"\n        ],\n        unique: true,\n        lowercase: true,\n        trim: true,\n        match: [\n            /^[a-z0-9-]+$/,\n            \"Slug can only contain lowercase letters, numbers, and hyphens\"\n        ]\n    },\n    description: {\n        type: String,\n        required: [\n            true,\n            \"Product description is required\"\n        ],\n        maxlength: [\n            2000,\n            \"Description cannot be more than 2000 characters\"\n        ]\n    },\n    shortDescription: {\n        type: String,\n        maxlength: [\n            200,\n            \"Short description cannot be more than 200 characters\"\n        ]\n    },\n    images: [\n        {\n            url: {\n                type: String,\n                required: true\n            },\n            alt: {\n                type: String,\n                required: true\n            },\n            publicId: {\n                type: String,\n                required: true\n            }\n        }\n    ],\n    price: {\n        type: Number,\n        required: [\n            true,\n            \"Product price is required\"\n        ],\n        min: [\n            0,\n            \"Price cannot be negative\"\n        ]\n    },\n    // Discount percentage (0-100)\n    discount: {\n        type: Number,\n        min: [\n            0,\n            \"Discount cannot be negative\"\n        ],\n        max: [\n            100,\n            \"Discount cannot be more than 100%\"\n        ],\n        default: 0\n    },\n    comparePrice: {\n        type: Number,\n        min: [\n            0,\n            \"Compare price cannot be negative\"\n        ]\n    },\n    stock: {\n        type: Number,\n        required: [\n            true,\n            \"Stock quantity is required\"\n        ],\n        min: [\n            0,\n            \"Stock cannot be negative\"\n        ],\n        default: 10\n    },\n    sku: {\n        type: String,\n        unique: true,\n        sparse: true,\n        trim: true\n    },\n    tags: [\n        {\n            type: String,\n            trim: true,\n            lowercase: true\n        }\n    ],\n    category: {\n        type: String,\n        required: [\n            true,\n            \"Product category is required\"\n        ],\n        enum: [\n            \"bangle-box\",\n            \"clutch\",\n            \"gift-hampers\",\n            \"goggle-cover\",\n            \"kitty-bag\",\n            \"long-tote-bag\",\n            \"picnic-bag\",\n            \"potli-purse\",\n            \"sling-bags\",\n            \"velvet-clutch-with-flaps\"\n        ]\n    },\n    subcategory: {\n        type: String,\n        trim: true\n    },\n    materials: [\n        {\n            type: String,\n            trim: true\n        }\n    ],\n    dimensions: {\n        length: Number,\n        width: Number,\n        height: Number,\n        unit: {\n            type: String,\n            enum: [\n                \"cm\",\n                \"inches\"\n            ],\n            default: \"cm\"\n        }\n    },\n    weight: {\n        value: Number,\n        unit: {\n            type: String,\n            enum: [\n                \"g\",\n                \"kg\",\n                \"lbs\"\n            ],\n            default: \"g\"\n        }\n    },\n    colors: [\n        {\n            name: String,\n            hex: String\n        }\n    ],\n    colorVariants: [\n        {\n            name: {\n                type: String,\n                required: true,\n                trim: true\n            },\n            hex: {\n                type: String,\n                required: true,\n                match: [\n                    /^#[0-9A-Fa-f]{6}$/,\n                    \"Hex color must be in format #RRGGBB\"\n                ]\n            },\n            images: [\n                {\n                    type: String,\n                    trim: true\n                }\n            ]\n        }\n    ],\n    published: {\n        type: Boolean,\n        default: true\n    },\n    featured: {\n        type: Boolean,\n        default: false\n    },\n    seo: {\n        metaTitle: {\n            type: String,\n            maxlength: [\n                60,\n                \"Meta title cannot be more than 60 characters\"\n            ]\n        },\n        metaDescription: {\n            type: String,\n            maxlength: [\n                160,\n                \"Meta description cannot be more than 160 characters\"\n            ]\n        },\n        keywords: [\n            String\n        ]\n    },\n    ratings: {\n        average: {\n            type: Number,\n            default: 0,\n            min: 0,\n            max: 5\n        },\n        count: {\n            type: Number,\n            default: 0,\n            min: 0\n        }\n    },\n    salesCount: {\n        type: Number,\n        default: 0,\n        min: 0\n    },\n    isHandmade: {\n        type: Boolean,\n        default: true\n    },\n    madeIn: {\n        type: String,\n        default: \"India\"\n    },\n    careInstructions: {\n        type: String,\n        maxlength: [\n            500,\n            \"Care instructions cannot be more than 500 characters\"\n        ]\n    }\n}, {\n    timestamps: true\n});\n// Indexes for efficient queries\nproductSchema.index({\n    slug: 1\n});\nproductSchema.index({\n    category: 1\n});\nproductSchema.index({\n    tags: 1\n});\nproductSchema.index({\n    published: 1\n});\nproductSchema.index({\n    featured: 1\n});\nproductSchema.index({\n    \"ratings.average\": -1\n});\nproductSchema.index({\n    salesCount: -1\n});\nproductSchema.index({\n    createdAt: -1\n});\nproductSchema.set(\"toJSON\", {\n    virtuals: true,\n    transform: function(doc, ret) {\n        delete ret.__v;\n        return ret;\n    }\n});\n// Virtual for discount percentage\nproductSchema.virtual(\"discountPercentage\").get(function() {\n    if (this.comparePrice && this.comparePrice > this.price) {\n        return Math.round((this.comparePrice - this.price) / this.comparePrice * 100);\n    }\n    return 0;\n});\n// Virtual for in stock status\nproductSchema.virtual(\"inStock\").get(function() {\n    return this.stock > 0;\n});\n// Virtual for main image\nproductSchema.virtual(\"mainImage\").get(function() {\n    return this.images.length > 0 ? this.images[0] : null;\n});\n// Instance method to update stock\nproductSchema.methods.updateStock = function(quantity) {\n    this.stock = Math.max(0, this.stock - quantity);\n    return this.save();\n};\n// Instance method to increment sales count\nproductSchema.methods.incrementSales = function(quantity = 1) {\n    this.salesCount += quantity;\n    return this.save();\n};\n// Static method to find published products\nproductSchema.statics.findPublished = function() {\n    return this.find({\n        published: true\n    });\n};\n// Static method to find featured products\nproductSchema.statics.findFeatured = function() {\n    return this.find({\n        published: true,\n        featured: true\n    });\n};\n// Static method to find by category\nproductSchema.statics.findByCategory = function(category) {\n    return this.find({\n        published: true,\n        category\n    });\n};\n// Static method to search products\nproductSchema.statics.search = function(query) {\n    return this.find({\n        published: true,\n        $or: [\n            {\n                title: {\n                    $regex: query,\n                    $options: \"i\"\n                }\n            },\n            {\n                description: {\n                    $regex: query,\n                    $options: \"i\"\n                }\n            },\n            {\n                tags: {\n                    $in: [\n                        new RegExp(query, \"i\")\n                    ]\n                }\n            }\n        ]\n    });\n};\n// Pre-save middleware to generate slug if not provided\nproductSchema.pre(\"save\", function(next) {\n    if (!this.slug && this.title) {\n        this.slug = this.title.toLowerCase().replace(/[^a-z0-9\\s-]/g, \"\").replace(/\\s+/g, \"-\").replace(/-+/g, \"-\").trim(\"-\");\n    }\n    next();\n});\n// Ensure virtuals are serialized\nproductSchema.set(\"toJSON\", {\n    virtuals: true,\n    transform: function(doc, ret) {\n        delete ret.__v;\n        return ret;\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).Product || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"Product\", productSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGlCQUFpQixJQUN6QkEsT0FBTyxDQUFDLFFBQVEsS0FDaEJBLE9BQU8sQ0FBQyxPQUFPLEtBQ2ZyRixJQUFJLENBQUM7SUFDVjtJQUNBbUY7QUFDRjtBQUVBLGlDQUFpQztBQUNqQ3pGLGNBQWM2RCxHQUFHLENBQUMsVUFBVTtJQUMxQkMsVUFBVTtJQUNWQyxXQUFXLFNBQVNDLEdBQUcsRUFBRUMsR0FBRztRQUMxQixPQUFPQSxJQUFJQyxHQUFHO1FBQ2QsT0FBT0Q7SUFDVDtBQUNGO0FBRUEsaUVBQWVsRSx3REFBZSxDQUFDOEYsT0FBTyxJQUFJOUYscURBQWMsQ0FBQyxXQUFXQyxjQUFjQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmlydmFhbmFhLWVjb21tZXJjZS8uL21vZGVscy9Qcm9kdWN0LmpzPzA5YzYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcblxuY29uc3QgcHJvZHVjdFNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xuICB0aXRsZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogW3RydWUsICdQcm9kdWN0IHRpdGxlIGlzIHJlcXVpcmVkJ10sXG4gICAgdHJpbTogdHJ1ZSxcbiAgICBtYXhsZW5ndGg6IFsxMDAsICdUaXRsZSBjYW5ub3QgYmUgbW9yZSB0aGFuIDEwMCBjaGFyYWN0ZXJzJ10sXG4gIH0sXG4gIHNsdWc6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCAnUHJvZHVjdCBzbHVnIGlzIHJlcXVpcmVkJ10sXG4gICAgdW5pcXVlOiB0cnVlLFxuICAgIGxvd2VyY2FzZTogdHJ1ZSxcbiAgICB0cmltOiB0cnVlLFxuICAgIG1hdGNoOiBbL15bYS16MC05LV0rJC8sICdTbHVnIGNhbiBvbmx5IGNvbnRhaW4gbG93ZXJjYXNlIGxldHRlcnMsIG51bWJlcnMsIGFuZCBoeXBoZW5zJ10sXG4gIH0sXG4gIGRlc2NyaXB0aW9uOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ1Byb2R1Y3QgZGVzY3JpcHRpb24gaXMgcmVxdWlyZWQnXSxcbiAgICBtYXhsZW5ndGg6IFsyMDAwLCAnRGVzY3JpcHRpb24gY2Fubm90IGJlIG1vcmUgdGhhbiAyMDAwIGNoYXJhY3RlcnMnXSxcbiAgfSxcbiAgc2hvcnREZXNjcmlwdGlvbjoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBtYXhsZW5ndGg6IFsyMDAsICdTaG9ydCBkZXNjcmlwdGlvbiBjYW5ub3QgYmUgbW9yZSB0aGFuIDIwMCBjaGFyYWN0ZXJzJ10sXG4gIH0sXG4gIGltYWdlczogW3tcbiAgICB1cmw6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgYWx0OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHB1YmxpY0lkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICB9XSxcbiAgcHJpY2U6IHtcbiAgICB0eXBlOiBOdW1iZXIsXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCAnUHJvZHVjdCBwcmljZSBpcyByZXF1aXJlZCddLFxuICAgIG1pbjogWzAsICdQcmljZSBjYW5ub3QgYmUgbmVnYXRpdmUnXSxcbiAgfSxcbiAgLy8gRGlzY291bnQgcGVyY2VudGFnZSAoMC0xMDApXG4gIGRpc2NvdW50OiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICAgIG1pbjogWzAsICdEaXNjb3VudCBjYW5ub3QgYmUgbmVnYXRpdmUnXSxcbiAgICBtYXg6IFsxMDAsICdEaXNjb3VudCBjYW5ub3QgYmUgbW9yZSB0aGFuIDEwMCUnXSxcbiAgICBkZWZhdWx0OiAwLFxuICB9LFxuICBjb21wYXJlUHJpY2U6IHtcbiAgICB0eXBlOiBOdW1iZXIsXG4gICAgbWluOiBbMCwgJ0NvbXBhcmUgcHJpY2UgY2Fubm90IGJlIG5lZ2F0aXZlJ10sXG4gIH0sXG4gIHN0b2NrOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ1N0b2NrIHF1YW50aXR5IGlzIHJlcXVpcmVkJ10sXG4gICAgbWluOiBbMCwgJ1N0b2NrIGNhbm5vdCBiZSBuZWdhdGl2ZSddLFxuICAgIGRlZmF1bHQ6IDEwLFxuICB9LFxuICBza3U6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgdW5pcXVlOiB0cnVlLFxuICAgIHNwYXJzZTogdHJ1ZSxcbiAgICB0cmltOiB0cnVlLFxuICB9LFxuICB0YWdzOiBbe1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICB0cmltOiB0cnVlLFxuICAgIGxvd2VyY2FzZTogdHJ1ZSxcbiAgfV0sXG4gIGNhdGVnb3J5OiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ1Byb2R1Y3QgY2F0ZWdvcnkgaXMgcmVxdWlyZWQnXSxcbiAgICBlbnVtOiBbXG4gICAgICAnYmFuZ2xlLWJveCcsXG4gICAgICAnY2x1dGNoJyxcbiAgICAgICdnaWZ0LWhhbXBlcnMnLFxuICAgICAgJ2dvZ2dsZS1jb3ZlcicsXG4gICAgICAna2l0dHktYmFnJyxcbiAgICAgICdsb25nLXRvdGUtYmFnJyxcbiAgICAgICdwaWNuaWMtYmFnJyxcbiAgICAgICdwb3RsaS1wdXJzZScsXG4gICAgICAnc2xpbmctYmFncycsXG4gICAgICAndmVsdmV0LWNsdXRjaC13aXRoLWZsYXBzJ1xuICAgIF0sXG4gIH0sXG4gIHN1YmNhdGVnb3J5OiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHRyaW06IHRydWUsXG4gIH0sXG4gIG1hdGVyaWFsczogW3tcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgdHJpbTogdHJ1ZSxcbiAgfV0sXG4gIGRpbWVuc2lvbnM6IHtcbiAgICBsZW5ndGg6IE51bWJlcixcbiAgICB3aWR0aDogTnVtYmVyLFxuICAgIGhlaWdodDogTnVtYmVyLFxuICAgIHVuaXQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGVudW06IFsnY20nLCAnaW5jaGVzJ10sXG4gICAgICBkZWZhdWx0OiAnY20nLFxuICAgIH0sXG4gIH0sXG4gIHdlaWdodDoge1xuICAgIHZhbHVlOiBOdW1iZXIsXG4gICAgdW5pdDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZW51bTogWydnJywgJ2tnJywgJ2xicyddLFxuICAgICAgZGVmYXVsdDogJ2cnLFxuICAgIH0sXG4gIH0sXG4gIGNvbG9yczogW3tcbiAgICBuYW1lOiBTdHJpbmcsXG4gICAgaGV4OiBTdHJpbmcsXG4gIH1dLFxuICBjb2xvclZhcmlhbnRzOiBbe1xuICAgIG5hbWU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgdHJpbTogdHJ1ZSxcbiAgICB9LFxuICAgIGhleDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBtYXRjaDogWy9eI1swLTlBLUZhLWZdezZ9JC8sICdIZXggY29sb3IgbXVzdCBiZSBpbiBmb3JtYXQgI1JSR0dCQiddLFxuICAgIH0sXG4gICAgaW1hZ2VzOiBbe1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgdHJpbTogdHJ1ZSxcbiAgICB9XSxcbiAgfV0sXG4gIHB1Ymxpc2hlZDoge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogdHJ1ZSxcbiAgfSxcbiAgZmVhdHVyZWQ6IHtcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlZmF1bHQ6IGZhbHNlLFxuICB9LFxuICBzZW86IHtcbiAgICBtZXRhVGl0bGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIG1heGxlbmd0aDogWzYwLCAnTWV0YSB0aXRsZSBjYW5ub3QgYmUgbW9yZSB0aGFuIDYwIGNoYXJhY3RlcnMnXSxcbiAgICB9LFxuICAgIG1ldGFEZXNjcmlwdGlvbjoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgbWF4bGVuZ3RoOiBbMTYwLCAnTWV0YSBkZXNjcmlwdGlvbiBjYW5ub3QgYmUgbW9yZSB0aGFuIDE2MCBjaGFyYWN0ZXJzJ10sXG4gICAgfSxcbiAgICBrZXl3b3JkczogW1N0cmluZ10sXG4gIH0sXG4gIHJhdGluZ3M6IHtcbiAgICBhdmVyYWdlOiB7XG4gICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICBkZWZhdWx0OiAwLFxuICAgICAgbWluOiAwLFxuICAgICAgbWF4OiA1LFxuICAgIH0sXG4gICAgY291bnQ6IHtcbiAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgIGRlZmF1bHQ6IDAsXG4gICAgICBtaW46IDAsXG4gICAgfSxcbiAgfSxcbiAgc2FsZXNDb3VudDoge1xuICAgIHR5cGU6IE51bWJlcixcbiAgICBkZWZhdWx0OiAwLFxuICAgIG1pbjogMCxcbiAgfSxcbiAgaXNIYW5kbWFkZToge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogdHJ1ZSxcbiAgfSxcbiAgbWFkZUluOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6ICdJbmRpYScsXG4gIH0sXG4gIGNhcmVJbnN0cnVjdGlvbnM6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgbWF4bGVuZ3RoOiBbNTAwLCAnQ2FyZSBpbnN0cnVjdGlvbnMgY2Fubm90IGJlIG1vcmUgdGhhbiA1MDAgY2hhcmFjdGVycyddLFxuICB9LFxufSwge1xuICB0aW1lc3RhbXBzOiB0cnVlLFxufSk7XG5cbi8vIEluZGV4ZXMgZm9yIGVmZmljaWVudCBxdWVyaWVzXG5wcm9kdWN0U2NoZW1hLmluZGV4KHsgc2x1ZzogMSB9KTtcbnByb2R1Y3RTY2hlbWEuaW5kZXgoeyBjYXRlZ29yeTogMSB9KTtcbnByb2R1Y3RTY2hlbWEuaW5kZXgoeyB0YWdzOiAxIH0pO1xucHJvZHVjdFNjaGVtYS5pbmRleCh7IHB1Ymxpc2hlZDogMSB9KTtcbnByb2R1Y3RTY2hlbWEuaW5kZXgoeyBmZWF0dXJlZDogMSB9KTtcbnByb2R1Y3RTY2hlbWEuaW5kZXgoeyAncmF0aW5ncy5hdmVyYWdlJzogLTEgfSk7XG5wcm9kdWN0U2NoZW1hLmluZGV4KHsgc2FsZXNDb3VudDogLTEgfSk7XG5wcm9kdWN0U2NoZW1hLmluZGV4KHsgY3JlYXRlZEF0OiAtMSB9KTtcbnByb2R1Y3RTY2hlbWEuc2V0KCd0b0pTT04nLCB7XG4gIHZpcnR1YWxzOiB0cnVlLFxuICB0cmFuc2Zvcm06IGZ1bmN0aW9uIChkb2MsIHJldCkge1xuICAgIGRlbGV0ZSByZXQuX192O1xuICAgIHJldHVybiByZXQ7XG4gIH0sXG59KTtcblxuXG4vLyBWaXJ0dWFsIGZvciBkaXNjb3VudCBwZXJjZW50YWdlXG5wcm9kdWN0U2NoZW1hLnZpcnR1YWwoJ2Rpc2NvdW50UGVyY2VudGFnZScpLmdldChmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMuY29tcGFyZVByaWNlICYmIHRoaXMuY29tcGFyZVByaWNlID4gdGhpcy5wcmljZSkge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKCgodGhpcy5jb21wYXJlUHJpY2UgLSB0aGlzLnByaWNlKSAvIHRoaXMuY29tcGFyZVByaWNlKSAqIDEwMCk7XG4gIH1cbiAgcmV0dXJuIDA7XG59KTtcblxuLy8gVmlydHVhbCBmb3IgaW4gc3RvY2sgc3RhdHVzXG5wcm9kdWN0U2NoZW1hLnZpcnR1YWwoJ2luU3RvY2snKS5nZXQoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5zdG9jayA+IDA7XG59KTtcblxuXG4vLyBWaXJ0dWFsIGZvciBtYWluIGltYWdlXG5wcm9kdWN0U2NoZW1hLnZpcnR1YWwoJ21haW5JbWFnZScpLmdldChmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuaW1hZ2VzLmxlbmd0aCA+IDAgPyB0aGlzLmltYWdlc1swXSA6IG51bGw7XG59KTtcblxuLy8gSW5zdGFuY2UgbWV0aG9kIHRvIHVwZGF0ZSBzdG9ja1xucHJvZHVjdFNjaGVtYS5tZXRob2RzLnVwZGF0ZVN0b2NrID0gZnVuY3Rpb24ocXVhbnRpdHkpIHtcbiAgdGhpcy5zdG9jayA9IE1hdGgubWF4KDAsIHRoaXMuc3RvY2sgLSBxdWFudGl0eSk7XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIEluc3RhbmNlIG1ldGhvZCB0byBpbmNyZW1lbnQgc2FsZXMgY291bnRcbnByb2R1Y3RTY2hlbWEubWV0aG9kcy5pbmNyZW1lbnRTYWxlcyA9IGZ1bmN0aW9uKHF1YW50aXR5ID0gMSkge1xuICB0aGlzLnNhbGVzQ291bnQgKz0gcXVhbnRpdHk7XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIFN0YXRpYyBtZXRob2QgdG8gZmluZCBwdWJsaXNoZWQgcHJvZHVjdHNcbnByb2R1Y3RTY2hlbWEuc3RhdGljcy5maW5kUHVibGlzaGVkID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmZpbmQoeyBwdWJsaXNoZWQ6IHRydWUgfSk7XG59O1xuXG4vLyBTdGF0aWMgbWV0aG9kIHRvIGZpbmQgZmVhdHVyZWQgcHJvZHVjdHNcbnByb2R1Y3RTY2hlbWEuc3RhdGljcy5maW5kRmVhdHVyZWQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuZmluZCh7IHB1Ymxpc2hlZDogdHJ1ZSwgZmVhdHVyZWQ6IHRydWUgfSk7XG59O1xuXG4vLyBTdGF0aWMgbWV0aG9kIHRvIGZpbmQgYnkgY2F0ZWdvcnlcbnByb2R1Y3RTY2hlbWEuc3RhdGljcy5maW5kQnlDYXRlZ29yeSA9IGZ1bmN0aW9uKGNhdGVnb3J5KSB7XG4gIHJldHVybiB0aGlzLmZpbmQoeyBwdWJsaXNoZWQ6IHRydWUsIGNhdGVnb3J5IH0pO1xufTtcblxuLy8gU3RhdGljIG1ldGhvZCB0byBzZWFyY2ggcHJvZHVjdHNcbnByb2R1Y3RTY2hlbWEuc3RhdGljcy5zZWFyY2ggPSBmdW5jdGlvbihxdWVyeSkge1xuICByZXR1cm4gdGhpcy5maW5kKHtcbiAgICBwdWJsaXNoZWQ6IHRydWUsXG4gICAgJG9yOiBbXG4gICAgICB7IHRpdGxlOiB7ICRyZWdleDogcXVlcnksICRvcHRpb25zOiAnaScgfSB9LFxuICAgICAgeyBkZXNjcmlwdGlvbjogeyAkcmVnZXg6IHF1ZXJ5LCAkb3B0aW9uczogJ2knIH0gfSxcbiAgICAgIHsgdGFnczogeyAkaW46IFtuZXcgUmVnRXhwKHF1ZXJ5LCAnaScpXSB9IH0sXG4gICAgXSxcbiAgfSk7XG59O1xuXG4vLyBQcmUtc2F2ZSBtaWRkbGV3YXJlIHRvIGdlbmVyYXRlIHNsdWcgaWYgbm90IHByb3ZpZGVkXG5wcm9kdWN0U2NoZW1hLnByZSgnc2F2ZScsIGZ1bmN0aW9uKG5leHQpIHtcbiAgaWYgKCF0aGlzLnNsdWcgJiYgdGhpcy50aXRsZSkge1xuICAgIHRoaXMuc2x1ZyA9IHRoaXMudGl0bGVcbiAgICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgICAucmVwbGFjZSgvW15hLXowLTlcXHMtXS9nLCAnJylcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csICctJylcbiAgICAgIC5yZXBsYWNlKC8tKy9nLCAnLScpXG4gICAgICAudHJpbSgnLScpO1xuICB9XG4gIG5leHQoKTtcbn0pO1xuXG4vLyBFbnN1cmUgdmlydHVhbHMgYXJlIHNlcmlhbGl6ZWRcbnByb2R1Y3RTY2hlbWEuc2V0KCd0b0pTT04nLCB7XG4gIHZpcnR1YWxzOiB0cnVlLFxuICB0cmFuc2Zvcm06IGZ1bmN0aW9uKGRvYywgcmV0KSB7XG4gICAgZGVsZXRlIHJldC5fX3Y7XG4gICAgcmV0dXJuIHJldDtcbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBtb25nb29zZS5tb2RlbHMuUHJvZHVjdCB8fCBtb25nb29zZS5tb2RlbCgnUHJvZHVjdCcsIHByb2R1Y3RTY2hlbWEpO1xuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicHJvZHVjdFNjaGVtYSIsIlNjaGVtYSIsInRpdGxlIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwidHJpbSIsIm1heGxlbmd0aCIsInNsdWciLCJ1bmlxdWUiLCJsb3dlcmNhc2UiLCJtYXRjaCIsImRlc2NyaXB0aW9uIiwic2hvcnREZXNjcmlwdGlvbiIsImltYWdlcyIsInVybCIsImFsdCIsInB1YmxpY0lkIiwicHJpY2UiLCJOdW1iZXIiLCJtaW4iLCJkaXNjb3VudCIsIm1heCIsImRlZmF1bHQiLCJjb21wYXJlUHJpY2UiLCJzdG9jayIsInNrdSIsInNwYXJzZSIsInRhZ3MiLCJjYXRlZ29yeSIsImVudW0iLCJzdWJjYXRlZ29yeSIsIm1hdGVyaWFscyIsImRpbWVuc2lvbnMiLCJsZW5ndGgiLCJ3aWR0aCIsImhlaWdodCIsInVuaXQiLCJ3ZWlnaHQiLCJ2YWx1ZSIsImNvbG9ycyIsIm5hbWUiLCJoZXgiLCJjb2xvclZhcmlhbnRzIiwicHVibGlzaGVkIiwiQm9vbGVhbiIsImZlYXR1cmVkIiwic2VvIiwibWV0YVRpdGxlIiwibWV0YURlc2NyaXB0aW9uIiwia2V5d29yZHMiLCJyYXRpbmdzIiwiYXZlcmFnZSIsImNvdW50Iiwic2FsZXNDb3VudCIsImlzSGFuZG1hZGUiLCJtYWRlSW4iLCJjYXJlSW5zdHJ1Y3Rpb25zIiwidGltZXN0YW1wcyIsImluZGV4IiwiY3JlYXRlZEF0Iiwic2V0IiwidmlydHVhbHMiLCJ0cmFuc2Zvcm0iLCJkb2MiLCJyZXQiLCJfX3YiLCJ2aXJ0dWFsIiwiZ2V0IiwiTWF0aCIsInJvdW5kIiwibWV0aG9kcyIsInVwZGF0ZVN0b2NrIiwicXVhbnRpdHkiLCJzYXZlIiwiaW5jcmVtZW50U2FsZXMiLCJzdGF0aWNzIiwiZmluZFB1Ymxpc2hlZCIsImZpbmQiLCJmaW5kRmVhdHVyZWQiLCJmaW5kQnlDYXRlZ29yeSIsInNlYXJjaCIsInF1ZXJ5IiwiJG9yIiwiJHJlZ2V4IiwiJG9wdGlvbnMiLCIkaW4iLCJSZWdFeHAiLCJwcmUiLCJuZXh0IiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwibW9kZWxzIiwiUHJvZHVjdCIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./models/Product.js\n");

/***/ }),

/***/ "(rsc)/./models/Shipping.js":
/*!****************************!*\
  !*** ./models/Shipping.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst shippingSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    name: {\n        type: String,\n        required: [\n            true,\n            \"Shipping method name is required\"\n        ],\n        trim: true\n    },\n    description: {\n        type: String,\n        trim: true\n    },\n    cost: {\n        type: Number,\n        required: [\n            true,\n            \"Shipping cost is required\"\n        ],\n        min: [\n            0,\n            \"Shipping cost cannot be negative\"\n        ]\n    },\n    gstPercent: {\n        type: Number,\n        min: [\n            0,\n            \"GST cannot be negative\"\n        ],\n        max: [\n            100,\n            \"GST cannot exceed 100%\"\n        ],\n        default: 18\n    },\n    estimatedDays: {\n        min: {\n            type: Number,\n            required: true,\n            min: 1\n        },\n        max: {\n            type: Number,\n            required: true,\n            min: 1\n        }\n    },\n    isActive: {\n        type: Boolean,\n        default: true\n    },\n    isDefault: {\n        type: Boolean,\n        default: false\n    },\n    freeShippingThreshold: {\n        type: Number,\n        min: [\n            0,\n            \"Free shipping threshold cannot be negative\"\n        ]\n    },\n    applicableRegions: [\n        {\n            type: String,\n            trim: true\n        }\n    ],\n    weightLimit: {\n        type: Number,\n        min: [\n            0,\n            \"Weight limit cannot be negative\"\n        ]\n    },\n    dimensionsLimit: {\n        length: Number,\n        width: Number,\n        height: Number,\n        unit: {\n            type: String,\n            enum: [\n                \"cm\",\n                \"inches\"\n            ],\n            default: \"cm\"\n        }\n    }\n}, {\n    timestamps: true\n});\n// Indexes\nshippingSchema.index({\n    isActive: 1\n});\nshippingSchema.index({\n    isDefault: 1\n});\nshippingSchema.index({\n    cost: 1\n});\n// Static method to find active shipping methods\nshippingSchema.statics.findActive = function() {\n    return this.find({\n        isActive: true\n    }).sort({\n        cost: 1\n    });\n};\n// Static method to find default shipping method\nshippingSchema.statics.findDefault = function() {\n    return this.findOne({\n        isActive: true,\n        isDefault: true\n    });\n};\n// Static method to calculate shipping cost for an order\nshippingSchema.statics.calculateShipping = async function(orderTotal, weight, dimensions) {\n    const activeMethods = await this.findActive();\n    if (activeMethods.length === 0) {\n        return {\n            cost: 0,\n            method: null\n        };\n    }\n    // Check for free shipping threshold\n    for (const method of activeMethods){\n        if (method.freeShippingThreshold && orderTotal >= method.freeShippingThreshold) {\n            return {\n                cost: 0,\n                method\n            };\n        }\n    }\n    // Check weight and dimension limits\n    const applicableMethods = activeMethods.filter((method)=>{\n        if (method.weightLimit && weight > method.weightLimit) {\n            return false;\n        }\n        if (method.dimensionsLimit && dimensions) {\n            const { length, width, height } = dimensions;\n            const { length: maxLength, width: maxWidth, height: maxHeight } = method.dimensionsLimit;\n            if (length > maxLength || width > maxWidth || height > maxHeight) {\n                return false;\n            }\n        }\n        return true;\n    });\n    if (applicableMethods.length === 0) {\n        // Return the most expensive method if no method meets criteria\n        return {\n            cost: activeMethods[activeMethods.length - 1].cost,\n            method: activeMethods[activeMethods.length - 1]\n        };\n    }\n    // Return the cheapest applicable method\n    const cheapestMethod = applicableMethods[0];\n    return {\n        cost: cheapestMethod.cost,\n        method: cheapestMethod\n    };\n};\n// Ensure virtuals are serialized\nshippingSchema.set(\"toJSON\", {\n    virtuals: true,\n    transform: function(doc, ret) {\n        delete ret.__v;\n        return ret;\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).Shipping || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"Shipping\", shippingSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUN4QyxNQUFNLEVBQUVoQixNQUFNLEVBQUVDLEtBQUssRUFBRUMsTUFBTSxFQUFFLEdBQUdjO1lBQ2xDLE1BQU0sRUFBRWhCLFFBQVFxQixTQUFTLEVBQUVwQixPQUFPcUIsUUFBUSxFQUFFcEIsUUFBUXFCLFNBQVMsRUFBRSxHQUFHTCxPQUFPbkIsZUFBZTtZQUV4RixJQUFJQyxTQUFTcUIsYUFBYXBCLFFBQVFxQixZQUFZcEIsU0FBU3FCLFdBQVc7Z0JBQ2hFLE9BQU87WUFDVDtRQUNGO1FBRUEsT0FBTztJQUNUO0lBRUEsSUFBSUosa0JBQWtCbkIsTUFBTSxLQUFLLEdBQUc7UUFDbEMsK0RBQStEO1FBQy9ELE9BQU87WUFBRWQsTUFBTStCLGFBQWEsQ0FBQ0EsY0FBY2pCLE1BQU0sR0FBRyxFQUFFLENBQUNkLElBQUk7WUFBRWdDLFFBQVFELGFBQWEsQ0FBQ0EsY0FBY2pCLE1BQU0sR0FBRyxFQUFFO1FBQUM7SUFDL0c7SUFFQSx3Q0FBd0M7SUFDeEMsTUFBTXdCLGlCQUFpQkwsaUJBQWlCLENBQUMsRUFBRTtJQUMzQyxPQUFPO1FBQUVqQyxNQUFNc0MsZUFBZXRDLElBQUk7UUFBRWdDLFFBQVFNO0lBQWU7QUFDN0Q7QUFFQSxpQ0FBaUM7QUFDakM5QyxlQUFlK0MsR0FBRyxDQUFDLFVBQVU7SUFDM0JDLFVBQVU7SUFDVkMsV0FBVyxTQUFTQyxHQUFHLEVBQUVDLEdBQUc7UUFDMUIsT0FBT0EsSUFBSUMsR0FBRztRQUNkLE9BQU9EO0lBQ1Q7QUFDRjtBQUVBLGlFQUFlcEQsd0RBQWUsQ0FBQ3VELFFBQVEsSUFBSXZELHFEQUFjLENBQUMsWUFBWUMsZUFBZUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25pcnZhYW5hYS1lY29tbWVyY2UvLi9tb2RlbHMvU2hpcHBpbmcuanM/YmUyMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xyXG5cclxuY29uc3Qgc2hpcHBpbmdTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICBuYW1lOiB7XHJcbiAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICByZXF1aXJlZDogW3RydWUsICdTaGlwcGluZyBtZXRob2QgbmFtZSBpcyByZXF1aXJlZCddLFxyXG4gICAgdHJpbTogdHJ1ZSxcclxuICB9LFxyXG4gIGRlc2NyaXB0aW9uOiB7XHJcbiAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICB0cmltOiB0cnVlLFxyXG4gIH0sXHJcbiAgY29zdDoge1xyXG4gICAgdHlwZTogTnVtYmVyLFxyXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCAnU2hpcHBpbmcgY29zdCBpcyByZXF1aXJlZCddLFxyXG4gICAgbWluOiBbMCwgJ1NoaXBwaW5nIGNvc3QgY2Fubm90IGJlIG5lZ2F0aXZlJ10sXHJcbiAgfSxcclxuICBnc3RQZXJjZW50OiB7XHJcbiAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICBtaW46IFswLCAnR1NUIGNhbm5vdCBiZSBuZWdhdGl2ZSddLFxyXG4gICAgbWF4OiBbMTAwLCAnR1NUIGNhbm5vdCBleGNlZWQgMTAwJSddLFxyXG4gICAgZGVmYXVsdDogMTgsXHJcbiAgfSxcclxuICBlc3RpbWF0ZWREYXlzOiB7XHJcbiAgICBtaW46IHtcclxuICAgICAgdHlwZTogTnVtYmVyLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgbWluOiAxLFxyXG4gICAgfSxcclxuICAgIG1heDoge1xyXG4gICAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBtaW46IDEsXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgaXNBY3RpdmU6IHtcclxuICAgIHR5cGU6IEJvb2xlYW4sXHJcbiAgICBkZWZhdWx0OiB0cnVlLFxyXG4gIH0sXHJcbiAgaXNEZWZhdWx0OiB7XHJcbiAgICB0eXBlOiBCb29sZWFuLFxyXG4gICAgZGVmYXVsdDogZmFsc2UsXHJcbiAgfSxcclxuICBmcmVlU2hpcHBpbmdUaHJlc2hvbGQ6IHtcclxuICAgIHR5cGU6IE51bWJlcixcclxuICAgIG1pbjogWzAsICdGcmVlIHNoaXBwaW5nIHRocmVzaG9sZCBjYW5ub3QgYmUgbmVnYXRpdmUnXSxcclxuICB9LFxyXG4gIGFwcGxpY2FibGVSZWdpb25zOiBbe1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgdHJpbTogdHJ1ZSxcclxuICB9XSxcclxuICB3ZWlnaHRMaW1pdDoge1xyXG4gICAgdHlwZTogTnVtYmVyLFxyXG4gICAgbWluOiBbMCwgJ1dlaWdodCBsaW1pdCBjYW5ub3QgYmUgbmVnYXRpdmUnXSxcclxuICB9LFxyXG4gIGRpbWVuc2lvbnNMaW1pdDoge1xyXG4gICAgbGVuZ3RoOiBOdW1iZXIsXHJcbiAgICB3aWR0aDogTnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBOdW1iZXIsXHJcbiAgICB1bml0OiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgZW51bTogWydjbScsICdpbmNoZXMnXSxcclxuICAgICAgZGVmYXVsdDogJ2NtJyxcclxuICAgIH0sXHJcbiAgfSxcclxufSwge1xyXG4gIHRpbWVzdGFtcHM6IHRydWUsXHJcbn0pO1xyXG5cclxuLy8gSW5kZXhlc1xyXG5zaGlwcGluZ1NjaGVtYS5pbmRleCh7IGlzQWN0aXZlOiAxIH0pO1xyXG5zaGlwcGluZ1NjaGVtYS5pbmRleCh7IGlzRGVmYXVsdDogMSB9KTtcclxuc2hpcHBpbmdTY2hlbWEuaW5kZXgoeyBjb3N0OiAxIH0pO1xyXG5cclxuLy8gU3RhdGljIG1ldGhvZCB0byBmaW5kIGFjdGl2ZSBzaGlwcGluZyBtZXRob2RzXHJcbnNoaXBwaW5nU2NoZW1hLnN0YXRpY3MuZmluZEFjdGl2ZSA9IGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiB0aGlzLmZpbmQoeyBpc0FjdGl2ZTogdHJ1ZSB9KS5zb3J0KHsgY29zdDogMSB9KTtcclxufTtcclxuXHJcbi8vIFN0YXRpYyBtZXRob2QgdG8gZmluZCBkZWZhdWx0IHNoaXBwaW5nIG1ldGhvZFxyXG5zaGlwcGluZ1NjaGVtYS5zdGF0aWNzLmZpbmREZWZhdWx0ID0gZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHRoaXMuZmluZE9uZSh7IGlzQWN0aXZlOiB0cnVlLCBpc0RlZmF1bHQ6IHRydWUgfSk7XHJcbn07XHJcblxyXG4vLyBTdGF0aWMgbWV0aG9kIHRvIGNhbGN1bGF0ZSBzaGlwcGluZyBjb3N0IGZvciBhbiBvcmRlclxyXG5zaGlwcGluZ1NjaGVtYS5zdGF0aWNzLmNhbGN1bGF0ZVNoaXBwaW5nID0gYXN5bmMgZnVuY3Rpb24ob3JkZXJUb3RhbCwgd2VpZ2h0LCBkaW1lbnNpb25zKSB7XHJcbiAgY29uc3QgYWN0aXZlTWV0aG9kcyA9IGF3YWl0IHRoaXMuZmluZEFjdGl2ZSgpO1xyXG4gIFxyXG4gIGlmIChhY3RpdmVNZXRob2RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgcmV0dXJuIHsgY29zdDogMCwgbWV0aG9kOiBudWxsIH07XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBmb3IgZnJlZSBzaGlwcGluZyB0aHJlc2hvbGRcclxuICBmb3IgKGNvbnN0IG1ldGhvZCBvZiBhY3RpdmVNZXRob2RzKSB7XHJcbiAgICBpZiAobWV0aG9kLmZyZWVTaGlwcGluZ1RocmVzaG9sZCAmJiBvcmRlclRvdGFsID49IG1ldGhvZC5mcmVlU2hpcHBpbmdUaHJlc2hvbGQpIHtcclxuICAgICAgcmV0dXJuIHsgY29zdDogMCwgbWV0aG9kIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayB3ZWlnaHQgYW5kIGRpbWVuc2lvbiBsaW1pdHNcclxuICBjb25zdCBhcHBsaWNhYmxlTWV0aG9kcyA9IGFjdGl2ZU1ldGhvZHMuZmlsdGVyKG1ldGhvZCA9PiB7XHJcbiAgICBpZiAobWV0aG9kLndlaWdodExpbWl0ICYmIHdlaWdodCA+IG1ldGhvZC53ZWlnaHRMaW1pdCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChtZXRob2QuZGltZW5zaW9uc0xpbWl0ICYmIGRpbWVuc2lvbnMpIHtcclxuICAgICAgY29uc3QgeyBsZW5ndGgsIHdpZHRoLCBoZWlnaHQgfSA9IGRpbWVuc2lvbnM7XHJcbiAgICAgIGNvbnN0IHsgbGVuZ3RoOiBtYXhMZW5ndGgsIHdpZHRoOiBtYXhXaWR0aCwgaGVpZ2h0OiBtYXhIZWlnaHQgfSA9IG1ldGhvZC5kaW1lbnNpb25zTGltaXQ7XHJcbiAgICAgIFxyXG4gICAgICBpZiAobGVuZ3RoID4gbWF4TGVuZ3RoIHx8IHdpZHRoID4gbWF4V2lkdGggfHwgaGVpZ2h0ID4gbWF4SGVpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0pO1xyXG5cclxuICBpZiAoYXBwbGljYWJsZU1ldGhvZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAvLyBSZXR1cm4gdGhlIG1vc3QgZXhwZW5zaXZlIG1ldGhvZCBpZiBubyBtZXRob2QgbWVldHMgY3JpdGVyaWFcclxuICAgIHJldHVybiB7IGNvc3Q6IGFjdGl2ZU1ldGhvZHNbYWN0aXZlTWV0aG9kcy5sZW5ndGggLSAxXS5jb3N0LCBtZXRob2Q6IGFjdGl2ZU1ldGhvZHNbYWN0aXZlTWV0aG9kcy5sZW5ndGggLSAxXSB9O1xyXG4gIH1cclxuXHJcbiAgLy8gUmV0dXJuIHRoZSBjaGVhcGVzdCBhcHBsaWNhYmxlIG1ldGhvZFxyXG4gIGNvbnN0IGNoZWFwZXN0TWV0aG9kID0gYXBwbGljYWJsZU1ldGhvZHNbMF07XHJcbiAgcmV0dXJuIHsgY29zdDogY2hlYXBlc3RNZXRob2QuY29zdCwgbWV0aG9kOiBjaGVhcGVzdE1ldGhvZCB9O1xyXG59O1xyXG5cclxuLy8gRW5zdXJlIHZpcnR1YWxzIGFyZSBzZXJpYWxpemVkXHJcbnNoaXBwaW5nU2NoZW1hLnNldCgndG9KU09OJywge1xyXG4gIHZpcnR1YWxzOiB0cnVlLFxyXG4gIHRyYW5zZm9ybTogZnVuY3Rpb24oZG9jLCByZXQpIHtcclxuICAgIGRlbGV0ZSByZXQuX192O1xyXG4gICAgcmV0dXJuIHJldDtcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IG1vbmdvb3NlLm1vZGVscy5TaGlwcGluZyB8fCBtb25nb29zZS5tb2RlbCgnU2hpcHBpbmcnLCBzaGlwcGluZ1NjaGVtYSk7XHJcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsInNoaXBwaW5nU2NoZW1hIiwiU2NoZW1hIiwibmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsInRyaW0iLCJkZXNjcmlwdGlvbiIsImNvc3QiLCJOdW1iZXIiLCJtaW4iLCJnc3RQZXJjZW50IiwibWF4IiwiZGVmYXVsdCIsImVzdGltYXRlZERheXMiLCJpc0FjdGl2ZSIsIkJvb2xlYW4iLCJpc0RlZmF1bHQiLCJmcmVlU2hpcHBpbmdUaHJlc2hvbGQiLCJhcHBsaWNhYmxlUmVnaW9ucyIsIndlaWdodExpbWl0IiwiZGltZW5zaW9uc0xpbWl0IiwibGVuZ3RoIiwid2lkdGgiLCJoZWlnaHQiLCJ1bml0IiwiZW51bSIsInRpbWVzdGFtcHMiLCJpbmRleCIsInN0YXRpY3MiLCJmaW5kQWN0aXZlIiwiZmluZCIsInNvcnQiLCJmaW5kRGVmYXVsdCIsImZpbmRPbmUiLCJjYWxjdWxhdGVTaGlwcGluZyIsIm9yZGVyVG90YWwiLCJ3ZWlnaHQiLCJkaW1lbnNpb25zIiwiYWN0aXZlTWV0aG9kcyIsIm1ldGhvZCIsImFwcGxpY2FibGVNZXRob2RzIiwiZmlsdGVyIiwibWF4TGVuZ3RoIiwibWF4V2lkdGgiLCJtYXhIZWlnaHQiLCJjaGVhcGVzdE1ldGhvZCIsInNldCIsInZpcnR1YWxzIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwibW9kZWxzIiwiU2hpcHBpbmciLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./models/Shipping.js\n");

/***/ }),

/***/ "(rsc)/./models/User.js":
/*!************************!*\
  !*** ./models/User.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst userSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    name: {\n        type: String,\n        required: [\n            true,\n            \"Name is required\"\n        ],\n        trim: true,\n        maxlength: [\n            50,\n            \"Name cannot be more than 50 characters\"\n        ]\n    },\n    email: {\n        type: String,\n        required: [\n            true,\n            \"Email is required\"\n        ],\n        unique: true,\n        lowercase: true,\n        trim: true,\n        match: [\n            /^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/,\n            \"Please enter a valid email\"\n        ]\n    },\n    passwordHash: {\n        type: String,\n        required: function() {\n            return !this.googleId && !this.facebookId; // Password required only for email/password auth\n        }\n    },\n    role: {\n        type: String,\n        enum: [\n            \"user\",\n            \"admin\"\n        ],\n        default: \"user\"\n    },\n    googleId: {\n        type: String,\n        sparse: true\n    },\n    facebookId: {\n        type: String,\n        sparse: true\n    },\n    image: {\n        type: String\n    },\n    profileImage: {\n        type: String\n    },\n    phone: {\n        type: String,\n        match: [\n            /^\\+?[\\d\\s-()]+$/,\n            \"Please enter a valid phone number\"\n        ]\n    },\n    addresses: [\n        {\n            type: {\n                type: String,\n                enum: [\n                    \"shipping\",\n                    \"billing\"\n                ],\n                required: true\n            },\n            street: {\n                type: String,\n                required: true\n            },\n            city: {\n                type: String,\n                required: true\n            },\n            state: {\n                type: String,\n                required: true\n            },\n            zipCode: {\n                type: String,\n                required: true\n            },\n            country: {\n                type: String,\n                required: true,\n                default: \"India\"\n            },\n            isDefault: {\n                type: Boolean,\n                default: false\n            }\n        }\n    ],\n    shippingAddress: {\n        name: String,\n        street: String,\n        city: String,\n        state: String,\n        zipCode: String,\n        country: {\n            type: String,\n            default: \"India\"\n        },\n        phone: String\n    },\n    emailVerified: {\n        type: Boolean,\n        default: false\n    },\n    isActive: {\n        type: Boolean,\n        default: true\n    },\n    // Persist simple cart and wishlist on user profile\n    cart: [\n        {\n            productId: {\n                type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema).Types.ObjectId,\n                ref: \"Product\"\n            },\n            name: String,\n            image: String,\n            price: Number,\n            quantity: {\n                type: Number,\n                default: 1\n            },\n            slug: String\n        }\n    ],\n    wishlist: [\n        {\n            productId: {\n                type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema).Types.ObjectId,\n                ref: \"Product\"\n            },\n            name: String,\n            image: String,\n            price: Number,\n            slug: String,\n            addedAt: {\n                type: Date,\n                default: Date.now\n            }\n        }\n    ],\n    lastLogin: {\n        type: Date\n    },\n    resetPasswordToken: {\n        type: String\n    },\n    resetPasswordExpires: {\n        type: Date\n    }\n}, {\n    timestamps: true\n});\n// Index for efficient queries\nuserSchema.index({\n    email: 1\n});\nuserSchema.index({\n    googleId: 1\n});\nuserSchema.index({\n    facebookId: 1\n});\nuserSchema.index({\n    role: 1\n});\n// Virtual for password (not stored in DB)\nuserSchema.virtual(\"password\").set(function(password) {\n    if (password) {\n        this.passwordHash = bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hashSync(password, 12);\n    }\n}).get(function() {\n    return this.passwordHash;\n});\n// Instance method to check password\nuserSchema.methods.checkPassword = function(password) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compareSync(password, this.passwordHash);\n};\n// Instance method to get public profile\nuserSchema.methods.getPublicProfile = function() {\n    const userObject = this.toObject();\n    delete userObject.passwordHash;\n    delete userObject.__v;\n    return userObject;\n};\n// Static method to find by email\nuserSchema.statics.findByEmail = function(email) {\n    return this.findOne({\n        email: email.toLowerCase()\n    });\n};\n// Static method to find admin users\nuserSchema.statics.findAdmins = function() {\n    return this.find({\n        role: \"admin\"\n    });\n};\n// Pre-save middleware to ensure unique email\nuserSchema.pre(\"save\", async function(next) {\n    if (this.isModified(\"email\")) {\n        const existingUser = await this.constructor.findOne({\n            email: this.email,\n            _id: {\n                $ne: this._id\n            }\n        });\n        if (existingUser) {\n            throw new Error(\"Email already exists\");\n        }\n    }\n    next();\n});\n// Ensure virtuals are serialized\nuserSchema.set(\"toJSON\", {\n    virtuals: true,\n    transform: function(doc, ret) {\n        delete ret.passwordHash;\n        delete ret.__v;\n        return ret;\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).User || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"User\", userSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztBQUM3Q2YsV0FBV3FFLEdBQUcsQ0FBQyxRQUFRLGVBQWVDLElBQUk7SUFDeEMsSUFBSSxJQUFJLENBQUNDLFVBQVUsQ0FBQyxVQUFVO1FBQzVCLE1BQU1DLGVBQWUsTUFBTSxJQUFJLENBQUNDLFdBQVcsQ0FBQ1IsT0FBTyxDQUFDO1lBQ2xEekQsT0FBTyxJQUFJLENBQUNBLEtBQUs7WUFDakJrRSxLQUFLO2dCQUFFQyxLQUFLLElBQUksQ0FBQ0QsR0FBRztZQUFDO1FBQ3ZCO1FBQ0EsSUFBSUYsY0FBYztZQUNoQixNQUFNLElBQUlJLE1BQU07UUFDbEI7SUFDRjtJQUNBTjtBQUNGO0FBRUEsaUNBQWlDO0FBQ2pDdEUsV0FBV29ELEdBQUcsQ0FBQyxVQUFVO0lBQ3ZCeUIsVUFBVTtJQUNWQyxXQUFXLFNBQVNDLEdBQUcsRUFBRUMsR0FBRztRQUMxQixPQUFPQSxJQUFJcEUsWUFBWTtRQUN2QixPQUFPb0UsSUFBSWxCLEdBQUc7UUFDZCxPQUFPa0I7SUFDVDtBQUNGO0FBRUEsaUVBQWVsRix3REFBZSxDQUFDb0YsSUFBSSxJQUFJcEYscURBQWMsQ0FBQyxRQUFRRSxXQUFXQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmlydmFhbmFhLWVjb21tZXJjZS8uL21vZGVscy9Vc2VyLmpzPzczNjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0anMnO1xuXG5jb25zdCB1c2VyU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIG5hbWU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCAnTmFtZSBpcyByZXF1aXJlZCddLFxuICAgIHRyaW06IHRydWUsXG4gICAgbWF4bGVuZ3RoOiBbNTAsICdOYW1lIGNhbm5vdCBiZSBtb3JlIHRoYW4gNTAgY2hhcmFjdGVycyddLFxuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogW3RydWUsICdFbWFpbCBpcyByZXF1aXJlZCddLFxuICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICBsb3dlcmNhc2U6IHRydWUsXG4gICAgdHJpbTogdHJ1ZSxcbiAgICBtYXRjaDogWy9eXFx3KyhbLi1dP1xcdyspKkBcXHcrKFsuLV0/XFx3KykqKFxcLlxcd3syLDN9KSskLywgJ1BsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsJ10sXG4gIH0sXG4gIHBhc3N3b3JkSGFzaDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gIXRoaXMuZ29vZ2xlSWQgJiYgIXRoaXMuZmFjZWJvb2tJZDsgLy8gUGFzc3dvcmQgcmVxdWlyZWQgb25seSBmb3IgZW1haWwvcGFzc3dvcmQgYXV0aFxuICAgIH0sXG4gIH0sXG4gIHJvbGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZW51bTogWyd1c2VyJywgJ2FkbWluJ10sXG4gICAgZGVmYXVsdDogJ3VzZXInLFxuICB9LFxuICBnb29nbGVJZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBzcGFyc2U6IHRydWUsXG4gIH0sXG4gIGZhY2Vib29rSWQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgc3BhcnNlOiB0cnVlLFxuICB9LFxuICBpbWFnZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgcHJvZmlsZUltYWdlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICB9LFxuICBwaG9uZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBtYXRjaDogWy9eXFwrP1tcXGRcXHMtKCldKyQvLCAnUGxlYXNlIGVudGVyIGEgdmFsaWQgcGhvbmUgbnVtYmVyJ10sXG4gIH0sXG4gIGFkZHJlc3NlczogW3tcbiAgICB0eXBlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBlbnVtOiBbJ3NoaXBwaW5nJywgJ2JpbGxpbmcnXSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc3RyZWV0OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNpdHk6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc3RhdGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgemlwQ29kZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjb3VudHJ5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6ICdJbmRpYScsXG4gICAgfSxcbiAgICBpc0RlZmF1bHQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICB9LFxuICB9XSxcbiAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgbmFtZTogU3RyaW5nLFxuICAgIHN0cmVldDogU3RyaW5nLFxuICAgIGNpdHk6IFN0cmluZyxcbiAgICBzdGF0ZTogU3RyaW5nLFxuICAgIHppcENvZGU6IFN0cmluZyxcbiAgICBjb3VudHJ5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAnSW5kaWEnLFxuICAgIH0sXG4gICAgcGhvbmU6IFN0cmluZyxcbiAgfSxcbiAgZW1haWxWZXJpZmllZDoge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG4gIGlzQWN0aXZlOiB7XG4gICAgdHlwZTogQm9vbGVhbixcbiAgICBkZWZhdWx0OiB0cnVlLFxuICB9LFxuICAvLyBQZXJzaXN0IHNpbXBsZSBjYXJ0IGFuZCB3aXNobGlzdCBvbiB1c2VyIHByb2ZpbGVcbiAgY2FydDogW1xuICAgIHtcbiAgICAgIHByb2R1Y3RJZDogeyB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIHJlZjogJ1Byb2R1Y3QnIH0sXG4gICAgICBuYW1lOiBTdHJpbmcsXG4gICAgICBpbWFnZTogU3RyaW5nLFxuICAgICAgcHJpY2U6IE51bWJlcixcbiAgICAgIHF1YW50aXR5OiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMSB9LFxuICAgICAgc2x1ZzogU3RyaW5nLFxuICAgIH1cbiAgXSxcbiAgd2lzaGxpc3Q6IFtcbiAgICB7XG4gICAgICBwcm9kdWN0SWQ6IHsgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLCByZWY6ICdQcm9kdWN0JyB9LFxuICAgICAgbmFtZTogU3RyaW5nLFxuICAgICAgaW1hZ2U6IFN0cmluZyxcbiAgICAgIHByaWNlOiBOdW1iZXIsXG4gICAgICBzbHVnOiBTdHJpbmcsXG4gICAgICBhZGRlZEF0OiB7IHR5cGU6IERhdGUsIGRlZmF1bHQ6IERhdGUubm93IH1cbiAgICB9XG4gIF0sXG4gIGxhc3RMb2dpbjoge1xuICAgIHR5cGU6IERhdGUsXG4gIH0sXG4gIHJlc2V0UGFzc3dvcmRUb2tlbjoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgcmVzZXRQYXNzd29yZEV4cGlyZXM6IHtcbiAgICB0eXBlOiBEYXRlLFxuICB9LFxufSwge1xuICB0aW1lc3RhbXBzOiB0cnVlLFxufSk7XG5cbi8vIEluZGV4IGZvciBlZmZpY2llbnQgcXVlcmllc1xudXNlclNjaGVtYS5pbmRleCh7IGVtYWlsOiAxIH0pO1xudXNlclNjaGVtYS5pbmRleCh7IGdvb2dsZUlkOiAxIH0pO1xudXNlclNjaGVtYS5pbmRleCh7IGZhY2Vib29rSWQ6IDEgfSk7XG51c2VyU2NoZW1hLmluZGV4KHsgcm9sZTogMSB9KTtcblxuLy8gVmlydHVhbCBmb3IgcGFzc3dvcmQgKG5vdCBzdG9yZWQgaW4gREIpXG51c2VyU2NoZW1hLnZpcnR1YWwoJ3Bhc3N3b3JkJylcbiAgLnNldChmdW5jdGlvbihwYXNzd29yZCkge1xuICAgIGlmIChwYXNzd29yZCkge1xuICAgICAgdGhpcy5wYXNzd29yZEhhc2ggPSBiY3J5cHQuaGFzaFN5bmMocGFzc3dvcmQsIDEyKTtcbiAgICB9XG4gIH0pXG4gIC5nZXQoZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucGFzc3dvcmRIYXNoO1xuICB9KTtcblxuLy8gSW5zdGFuY2UgbWV0aG9kIHRvIGNoZWNrIHBhc3N3b3JkXG51c2VyU2NoZW1hLm1ldGhvZHMuY2hlY2tQYXNzd29yZCA9IGZ1bmN0aW9uKHBhc3N3b3JkKSB7XG4gIHJldHVybiBiY3J5cHQuY29tcGFyZVN5bmMocGFzc3dvcmQsIHRoaXMucGFzc3dvcmRIYXNoKTtcbn07XG5cbi8vIEluc3RhbmNlIG1ldGhvZCB0byBnZXQgcHVibGljIHByb2ZpbGVcbnVzZXJTY2hlbWEubWV0aG9kcy5nZXRQdWJsaWNQcm9maWxlID0gZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHVzZXJPYmplY3QgPSB0aGlzLnRvT2JqZWN0KCk7XG4gIGRlbGV0ZSB1c2VyT2JqZWN0LnBhc3N3b3JkSGFzaDtcbiAgZGVsZXRlIHVzZXJPYmplY3QuX192O1xuICByZXR1cm4gdXNlck9iamVjdDtcbn07XG5cbi8vIFN0YXRpYyBtZXRob2QgdG8gZmluZCBieSBlbWFpbFxudXNlclNjaGVtYS5zdGF0aWNzLmZpbmRCeUVtYWlsID0gZnVuY3Rpb24oZW1haWwpIHtcbiAgcmV0dXJuIHRoaXMuZmluZE9uZSh7IGVtYWlsOiBlbWFpbC50b0xvd2VyQ2FzZSgpIH0pO1xufTtcblxuLy8gU3RhdGljIG1ldGhvZCB0byBmaW5kIGFkbWluIHVzZXJzXG51c2VyU2NoZW1hLnN0YXRpY3MuZmluZEFkbWlucyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5maW5kKHsgcm9sZTogJ2FkbWluJyB9KTtcbn07XG5cbi8vIFByZS1zYXZlIG1pZGRsZXdhcmUgdG8gZW5zdXJlIHVuaXF1ZSBlbWFpbFxudXNlclNjaGVtYS5wcmUoJ3NhdmUnLCBhc3luYyBmdW5jdGlvbihuZXh0KSB7XG4gIGlmICh0aGlzLmlzTW9kaWZpZWQoJ2VtYWlsJykpIHtcbiAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCB0aGlzLmNvbnN0cnVjdG9yLmZpbmRPbmUoeyBcbiAgICAgIGVtYWlsOiB0aGlzLmVtYWlsLCBcbiAgICAgIF9pZDogeyAkbmU6IHRoaXMuX2lkIH0gXG4gICAgfSk7XG4gICAgaWYgKGV4aXN0aW5nVXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbWFpbCBhbHJlYWR5IGV4aXN0cycpO1xuICAgIH1cbiAgfVxuICBuZXh0KCk7XG59KTtcblxuLy8gRW5zdXJlIHZpcnR1YWxzIGFyZSBzZXJpYWxpemVkXG51c2VyU2NoZW1hLnNldCgndG9KU09OJywge1xuICB2aXJ0dWFsczogdHJ1ZSxcbiAgdHJhbnNmb3JtOiBmdW5jdGlvbihkb2MsIHJldCkge1xuICAgIGRlbGV0ZSByZXQucGFzc3dvcmRIYXNoO1xuICAgIGRlbGV0ZSByZXQuX192O1xuICAgIHJldHVybiByZXQ7XG4gIH0sXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgbW9uZ29vc2UubW9kZWxzLlVzZXIgfHwgbW9uZ29vc2UubW9kZWwoJ1VzZXInLCB1c2VyU2NoZW1hKTtcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsImJjcnlwdCIsInVzZXJTY2hlbWEiLCJTY2hlbWEiLCJuYW1lIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwidHJpbSIsIm1heGxlbmd0aCIsImVtYWlsIiwidW5pcXVlIiwibG93ZXJjYXNlIiwibWF0Y2giLCJwYXNzd29yZEhhc2giLCJnb29nbGVJZCIsImZhY2Vib29rSWQiLCJyb2xlIiwiZW51bSIsImRlZmF1bHQiLCJzcGFyc2UiLCJpbWFnZSIsInByb2ZpbGVJbWFnZSIsInBob25lIiwiYWRkcmVzc2VzIiwic3RyZWV0IiwiY2l0eSIsInN0YXRlIiwiemlwQ29kZSIsImNvdW50cnkiLCJpc0RlZmF1bHQiLCJCb29sZWFuIiwic2hpcHBpbmdBZGRyZXNzIiwiZW1haWxWZXJpZmllZCIsImlzQWN0aXZlIiwiY2FydCIsInByb2R1Y3RJZCIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJwcmljZSIsIk51bWJlciIsInF1YW50aXR5Iiwic2x1ZyIsIndpc2hsaXN0IiwiYWRkZWRBdCIsIkRhdGUiLCJub3ciLCJsYXN0TG9naW4iLCJyZXNldFBhc3N3b3JkVG9rZW4iLCJyZXNldFBhc3N3b3JkRXhwaXJlcyIsInRpbWVzdGFtcHMiLCJpbmRleCIsInZpcnR1YWwiLCJzZXQiLCJwYXNzd29yZCIsImhhc2hTeW5jIiwiZ2V0IiwibWV0aG9kcyIsImNoZWNrUGFzc3dvcmQiLCJjb21wYXJlU3luYyIsImdldFB1YmxpY1Byb2ZpbGUiLCJ1c2VyT2JqZWN0IiwidG9PYmplY3QiLCJfX3YiLCJzdGF0aWNzIiwiZmluZEJ5RW1haWwiLCJmaW5kT25lIiwidG9Mb3dlckNhc2UiLCJmaW5kQWRtaW5zIiwiZmluZCIsInByZSIsIm5leHQiLCJpc01vZGlmaWVkIiwiZXhpc3RpbmdVc2VyIiwiY29uc3RydWN0b3IiLCJfaWQiLCIkbmUiLCJFcnJvciIsInZpcnR1YWxzIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwibW9kZWxzIiwiVXNlciIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./models/User.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/supports-color","vendor-chunks/ms","vendor-chunks/has-flag","vendor-chunks/bcryptjs","vendor-chunks/cookie","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/oauth","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/preact-render-to-string","vendor-chunks/uuid","vendor-chunks/oidc-token-hash","vendor-chunks/@panva","vendor-chunks/mime-db","vendor-chunks/mime-types","vendor-chunks/razorpay","vendor-chunks/rate-limiter-flexible","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/call-bind-apply-helpers","vendor-chunks/debug","vendor-chunks/get-proto","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/axios","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpayment-intent%2Froute&page=%2Fapi%2Fpayment-intent%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpayment-intent%2Froute.js&appDir=C%3A%5CUsers%5CAnanya%5CDownloads%5CNirvaanaa_current%5CNirvaanaa%20(1)%5CNirvaanaa%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAnanya%5CDownloads%5CNirvaanaa_current%5CNirvaanaa%20(1)%5CNirvaanaa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();