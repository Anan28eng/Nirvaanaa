const path=require('path');const fs=require('fs');const mongoose=require('mongoose');(async()=>{try{const env=fs.readFileSync(path.join(process.cwd(),'.env.local'),'utf8');const uri=env.split(/\r?\n/).find(l=>l.startsWith('MONGODB_URI')).split('=')[1].trim();await mongoose.connect(uri,{useNewUrlParser:true,useUnifiedTopology:true});const Ann=require(path.join(process.cwd(),'models','Announcement.js')).default;const ads=await Ann.find({type:'adbanner'});const anns=await Ann.find({type:'announcement'});console.log('Before ad count',ads.length,'ann count',anns.length);if(ads[0]){ads[0].isAdBannerActive = !ads[0].isAdBannerActive;await ads[0].save();console.log('Toggled ad to',ads[0].isAdBannerActive)}else console.log('No ad');if(anns[0]){anns[0].isAnnouncementActive = !anns[0].isAnnouncementActive;await anns[0].save();console.log('Toggled ann to',anns[0].isAnnouncementActive)}else console.log('No ann');const adActive = await Ann.findAdBanner();const annActive = await Ann.findAnnouncementBanner();console.log('Active ad:',adActive?adActive._id:null);console.log('Active ann:',annActive?annActive._id:null);process.exit(0);}catch(e){console.error('ERR',e&&e.stack?e.stack:e);process.exit(2)}})();
